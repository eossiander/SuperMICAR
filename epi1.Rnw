\chapter{Paper 1: Using SuperMICAR to study drug poisoning deaths}

\begin{abstract}
Death certificate data is often used to study the epidemiology of drug poisoning deaths, but the International Classification of Disease (ICD) codes used to tabulate death data do not convey all the information about the drugs named on death certificates. In the US and some other countries the SuperMICAR computer system is used to code deaths to ICD codes. The SuperMICAR system also stores verbatim the text entered for the cause of death. We used the SuperMICAR text entries to study the 7,859 drug poisoning deaths occurring to Washington State residents between 2003--2010. We tabulated the drugs named on death certificates, and computed age-adjusted and age-specific death rates for the top named drugs, and for prescription and illicit drugs. Methadone was named on 2,149 death certificates, and was the most frequently named drug, followed by alcohol, cocaine, oxycodone, and methamphetamine. For both men and women and at all ages, prescription drugs were involved in more deaths than were illicit drugs. Among the 25 drugs named most frequently, only 4 have unique ICD codes, and the other 21 can be tabulated only by using the SuperMICAR data.
%187 words
\end{abstract}

\begin{detail}
Description of proposed activity, for IRB application:

The purpose of the proposed study is to demonstrate how SuperMICAR data can be used to analyze
drug poisoning deaths, and to present an analysis for deaths occurring in
Washington State during 2003-2010.
The ICD-10 provides a detailed set of codes for classifying drug poisoning deaths, but it
is not detailed enough to record all of the information that is recorded on death
certificates. For example, among opioids, heroin and methadone have unique injury codes in the
ICD-10 (T40.1 and T40.3 respectively), but oxycodone, hydrocodone, morphine, "opiates NOS," and
many other opiates are all lumped into the same rubric (T40.2). Fentanyl and tramadol are lumped in
with other synthetic narcotics; all barbiturates have the same code, as do all the benzodiazepines.

Beginning around the year 2000, the SuperMICAR computer system was implemented in the US to help
classify causes of death (Washington State, from which we will draw data for this study, began
using it in 2003). With the SuperMICAR system, vital statistics staff key the actual text written
by the certifier on the cause-of-death portion of the death certificate. SuperMICAR parses the
text and produces ICD codes for both multiple and underlying causes of death. The SuperMICAR output
includes both the ICD codes and the text that was keyed into the program. 

The proposed study is descriptive. We will prepare a subset of the Washington death data consisting of records for all persons who died
of drug poisoning, according to the underlying cause of death on the record. 
For each record, we will parse the SuperMICAR data into separate words, classify each word as a drug word or not, and classify each drug word to its ICD code.

We will compute age-specific death rates for men, women, and both sexes together for the top 5 named drugs to describe the relationship between age and drug deaths. We will compute age-adjusted rates to describe the temporal pattern during 2003-2010. We will also compute age-specific and age-adjusted rates of poisoning deaths according to whether the death certificate named a prescription drug, an illicit drug, both, or neither. We will compile counts of the most frequently named substances among all poisoning deaths, and among deaths where a prescription drug was named and where an illicit drug was named. We will tabulate the frequency with which pairs of drugs are named together on the same death certificate. We will compile counts of the most commonly named substances for each 3-digit ICD-10 cause-of-death category, for each ICD-10 poisoning injury code, and for each category of intent (unintentional, suicide, and undetermined).
\end{detail}

\section{Introduction}
% around 3,200 words

\begin{detail}
from WISQARS, July 9, 2013 \url{http://www.cdc.gov/injury/wisqars/index.html}.

2010, United States
Poisoning Deaths and Rates per 100,000
All Races, Both Sexes, All Ages
ICD-10 Codes: X40-X49,X60-X69,X85-X90,Y10-Y19,
Y35.2, *U01(.6,.7)

2010, United States
Overall Motor Vehicle Deaths and Rates per 100,000
All Races, Both Sexes, All Ages
ICD-10 Codes: V02-V04,V09.0,V09.2,V12-V14,V19.0-V19.2,V19.4-V19.6,V20-V79,
V80.3-V80.5,V81.0-V81.1,V82.0-V82.1,V83-V86,V87.0-V87.8,
V88.0-V88.8,V89.0,V89.2, X82,Y03,Y32

Year   Number of Deaths 
        Motor vehicle    Poisoning (all intents)
2000	43,604           20,230
2010	35,498           42,917

\end{detail}


Poisoning deaths have increased to become the leading cause of injury
death in the US~\cite{Wisqars-9July2013}. In 2010, there were almost 43,000 poisoning deaths in the US, more than double the 20,000 deaths in 2000\cite{Wisqars-9July2013}. The primary source of information on these deaths is death
certificate data collected by the states, and maintained by the National Center of Health
Statistics~\cite{Freedman-2003}. Deaths are tabulated according to codes contained in the ``International
Statistical Classification of Diseases and Related Health Problems'' (ICD)~\cite{WHO-ICD-10}, which
is published by the World Health Organization and revised periodically. The ninth revision (ICD-9)
was used for coding deaths in the US between 1979 and 1998; the tenth revision (ICD-10) has been
used since 1999.

The ICD-10 provides a detailed set of codes for classifying drug poisoning deaths, but it
is not detailed enough to record all of the information that is recorded on death
certificates. For example, among opioids, heroin and methadone have unique injury codes in the
ICD-10 (T40.1 and T40.3 respectively), but oxycodone, hydrocodone, morphine, ``opiates NOS,'' and
many other opiates are all lumped into the same rubric (T40.2). Fentanyl and tramadol are lumped in
with other synthetic narcotics; all barbiturates have the same code, as do all the benzodiazepines.
The ICD codes may also provide an incomplete picture of the number of drugs found in the
body. If two or more drugs in the same rubric are written on the same line of the death
certificate, they will be represented by a single code.

Beginning around the year 2000, the SuperMICAR computer system was implemented in the US to help
classify causes of death~\cite{Glenn-1999} (Washington State, from which we drew data for this study, began
using it in 2003). With the SuperMICAR system, vital statistics staff key the actual text written
by the certifier on the cause-of-death portion of the death certificate. SuperMICAR parses the
text and produces ICD codes for both multiple and underlying causes of death. The SuperMICAR output
includes both the ICD codes and the text that was keyed into the program. Although the National
Center for Health Statistics does not routinely release SuperMICAR files, they can be obtained from
some state health departments.

The purpose of the present study is to demonstrate how SuperMICAR data can be used to analyze
drug poisoning deaths, and to present an analysis for deaths occurring in
Washington State during 2003--2010. This research involved only non-living subjects and was determined to be exempt from IRB review.

\section{Methods}

This is a descriptive study. We used death data from the Washington State Department of Health,
for deaths occurring to Washington residents during 2003--2010. From these deaths, we extracted the
7,859 deaths for which the underlying cause-of-death code indicated that the death was caused by
poisoning. We included deaths of all intents (unintentional, homicide, suicide, and undetermined),
and included deaths due to poisoning by drugs and by other substances. We excluded deaths caused by
complications of medical care. Our analysis only included deaths in the ICD poisoning
classifications, and did not include deaths that were classified as being due to drug or alcohol
dependence.

The cause-of-death section of the US standard death certificate~\cite{deathcert} has 4 lines in
``Part I'' where the certifier is to enter the immediate cause of death, and the conditions that
led to that cause, with the underlying cause of death entered on the lowest line of Part I. ``Part
II'' of the cause-of-death section has one line where the certifier may enter ``other significant
conditions contributing to death.'' For deaths due to an external cause, meaning anything other
than a disease process, and including drug poisoning deaths, the certifier is also required to fill
a box describing how the injury leading to the death occurred. A death certificate example for a
person who died of drug poisoning in Washington State is shown in \autoref{deathcert}.

\begin{figure}
\hspace{-0.5in}
\includegraphics[width=6.5in]{c:/user/Poisoning/SuperMICAR/DeathCertCODfilled.pdf}
\caption{\label{deathcert}Drug poisoning death certificate example, for a person who died in
Washington State. For this illustration, the fields included in the SuperMICAR data (items 32, 40, and 43) are filled in; other fields are left blank.}
\end{figure}

With the SuperMICAR system, vital statistics staff key into a computer the actual text that is
written by the certifier on the death certificate~\cite{Glenn-1999}. Staff do not make any
decisions regarding coding at the data entry stage. After data entry, the computer program
interprets the textual entries and generates ICD codes describing both the multiple causes and the
underlying cause of death, according to World Health Organization coding
guidelines~\cite{Anderson-2011}. The textual entries are stored as string variables, with two
strings for each line in Part I, one for the cause-of-death entry and one for the duration; a
single string for Part II; and a single string for the injury description.

We prepared a subset of the Washington death data which contained records for all persons who died
of drug poisoning, according to the underlying cause of death on the record. For each record, we
combined the string variables holding the cause-of-death information and the injury description 
into a single string variable. Then we parsed this string into separate words. Word combinations that belong together, such as ``carbon monoxide'' or ``muscle relaxant,'' were treated as a single word. We processed the words through a spelling correction module that we developed, then matched them against a ``drug word'' list, which included the names of drugs or other chemical substances that could cause poisoning, and against a ``nondrug word'' list consisting of all other words that we found on death certificates. If a
word did not match an entry in either list, we manually adjudicated whether it should be
added to the spelling correction module (i.e. the word was a misspelled or alternative version of a word on the drug or nondrug lists), the drug word list, or the nondrug word list. By the end
of the process, all words were classified as drug words or not. We retained the drug words for
further processing.

Deaths involving injuries (including poisonings) receive ICD codes from two distinct sets: one set describing the nature of the injury (e.g. `broken leg'), and one set describing the external cause of the injury (e.g. `fell off roof'). For poisonings, the injury codes describe the drug or other substance involved in the poisoning. Some injury codes describe a single drug (e.g. T40.3 is methadone), while some decribe a class of drugs (e.g. T42.3 includes `barbiturates'). The external cause codes describe the drug involved in the death, but usually in broader classes, and also denote the intent category (unintentional, homicide, suicide, or undetermined). We classified each drug word to both an injury code and an external cause code. We also categorized each drug word into one of several broad categories (see \autoref{cattab}).

\begin{table}
\caption{\label{cattab}List of general categories into which we classified all drug words}
\begin{tabular}{lp{4in}} \hline
Category       & Description								\\\hline
prescription   & a drug that is normally obtained through prescription or used 
                 in a clinic								\\
illicit        & a drug that is normally obtained on the street and is usually illegal	\\
either         & a term that may denote either a prescription or illicit drug (e.g. opiate) \\
OTC            & a drug normally used to treat illness and that can be obtained legally 
                 without a prescription (e.g. aspirin)					\\
alcohol        & any word denoting alcohol (but not alcoholism)				\\
nonspecific    & any word denoting a drug that does not name a drug (e.g. polypharmacy, 
	         drug, or tablet)							\\	
common         & commonly available substances that are either not meant for ingestion 
	         (e.g. auto exhaust, arsenic, butane), or are commonly consumed, but 
		 are not illicit and not meant to treat an illness (e.g. caffeine, tobacco) \\
disease        & a word denoting a medical condition or treatment (e.g. alcoholism, 
	         anticoagulation)							\\
unknown        & a word with an unknown meaning (probably a misspelling)		\\
\hline
\end{tabular}
\end{table}

\subsection{Statistical analysis}

We conducted a descriptive analysis. We computed age-specific death rates for men, women, and both sexes together for the top 5 named drugs to describe the relationship between age and drug deaths. We computed age-adjusted rates to describe the temporal pattern during 2003--2010. The age-adjusted rates were standardized to the US 2000 population. We also computed age-specific and age-adjusted rates of poisoning deaths according to whether the death certificate named a prescription drug, an illicit drug, both, or neither.

We compiled counts of the most frequently named substances among all poisoning deaths, and among deaths where a prescription drug was named and where an illicit drug was named. We tabulated the frequency with which pairs of drugs were named together on the same death certificate. We compiled counts of the most commonly named substances for each 3-digit ICD-10 cause-of-death category, for each ICD-10 poisoning injury code, and for each category of intent (unintentional, suicide, and undetermined).

\section{Results}
\myComment{
proportion of drug deaths that had classifiable substance names, and classifiable drug
names

results of analysis

In methods, you described how you classed drug names as medicaments/illicit drugs/other.
Tabulate:\\
- number of certs coded as prescription versus illicit, and how this compares with what
you get from the injury codes.\\
}

\begin{detail}

\begin{lstlisting}[language=sas]
libname sm  'c:\data\poisoning\SuperMICAR';
%include "c:\user\poisoning\SuperMICAR\generic.sas";
proc freq data=sm.TcodeWide;
   where underly3 ge 'X40' and st_res = '48';
   tables year underly3;
run;
\end{lstlisting}


results:

\bfs
\bvm
                         The SAS System                               12:08 Monday, November 21, 2011 455

                       The FREQ Procedure

                          Year of death

                                     Cumulative    Cumulative
    Year    Frequency     Percent     Frequency      Percent
    ---------------------------------------------------------
    2003         767        9.76           767         9.76
    2004         877       11.16          1644        20.92
    2005         927       11.80          2571        32.71
    2006         982       12.50          3553        45.21
    2007        1066       13.56          4619        58.77
    2008        1118       14.23          5737        73.00
    2009        1096       13.95          6833        86.94
    2010        1026       13.06          7859       100.00

                         The SAS System                               12:08 Monday, November 21, 2011 456

                       The FREQ Procedure

                Underlying cause of death (3 dgt)

                                       Cumulative    Cumulative
  UNDERLY3    Frequency     Percent     Frequency      Percent
  -------------------------------------------------------------
  X40               38        0.48            38         0.48
  X41              470        5.98           508         6.46
  X42             2308       29.37          2816        35.83
  X43                5        0.06          2821        35.90
  X44             2708       34.46          5529        70.35
  X45              162        2.06          5691        72.41
  X46               12        0.15          5703        72.57
  X47              123        1.57          5826        74.13
  X48                5        0.06          5831        74.20
  X49               19        0.24          5850        74.44
  X60               46        0.59          5896        75.02
  X61              253        3.22          6149        78.24
  X62              116        1.48          6265        79.72
  X63                2        0.03          6267        79.74
  X64              650        8.27          6917        88.01
  X65                8        0.10          6925        88.12
  X66               26        0.33          6951        88.45
  X67              338        4.30          7289        92.75
  X68                7        0.09          7296        92.84
  X69               15        0.19          7311        93.03
  X85               11        0.14          7322        93.17
  Y10               18        0.23          7340        93.40
  Y11               49        0.62          7389        94.02
  Y12              142        1.81          7531        95.83
  Y14              242        3.08          7773        98.91
  Y15               11        0.14          7784        99.05
  Y16                4        0.05          7788        99.10
  Y17               21        0.27          7809        99.36
  Y19                8        0.10          7817        99.47
  Y40                3        0.04          7820        99.50
  Y41                1        0.01          7821        99.52
  Y42                2        0.03          7823        99.54
  Y43                2        0.03          7825        99.57
  Y44                7        0.09          7832        99.66
  Y45                9        0.11          7841        99.77
  Y46                2        0.03          7843        99.80
  Y48                1        0.01          7844        99.81
  Y49                2        0.03          7846        99.83
  Y52                1        0.01          7847        99.85
  Y55                1        0.01          7848        99.86
  Y57               11        0.14          7859       100.00
\end{verbatim}
\efs

The dataset {\tt TcodeLong} has one record for each word that is mentioned on a death
certificate. If a drug word is mentioned more than once on a certificate, it is only
counted once. However, sometimes the same generic ingredient is mentioned in two
different ways, for example, ``oxycontin'' may be listed on one line and ``oxycodone'' on
another line. Here, I count the mentions of generic ingredients, not the mentions of
specific words. So I need to remove these duplicates before doing the count.

I want to list the most common named drugs, according to the class of the user. What are
the most common named prescription drugs among a) people who used only
prescription drugs, and b) people who also used illicit drugs? What are
the most common named illicit drugs among a) people who used only illicit drugs, and b)
people who also used prescription drugs?


\begin{lstlisting}[language=sas]
options ls=80;
data temp1;
   set sm.TcodeLong(where=(('X40' le underly3 le 'X49' or 'X60' le underly3 le 'X69' or
         underly3 = 'X85' or 'Y10' le underly3 le 'Y19') and st_res = '48'));
   drugword_generic = put(drugword,$generic.);
   drugword_cat = put(drugword,$licitcat.);
run;
proc sort data=temp1 out=GenericLong nodupkey;
   by certno drugword_generic;
run;

proc freq data=GenericLong noprint;
   tables drugword/out=wordlist;
   format drugword $generic.;
run;
proc sort data=wordlist;
   by descending count;
run;
proc print data=wordlist uniform;
run;
/*
How many of the 1240 certificates with the word opiate also list a specific opiate?
*/
data opiate(keep=certno);
   set GenericLong;
   where drugword_generic = 'c-OPIATE';
run;
proc sort data=opiate;
   by certno;
run;
proc sort data=GenericLong;
   by certno;
run;
data opiate2;
   merge GenericLong opiate(in=inopiate);
   by certno;
   if inopiate;
run;
/*
specific opiates are:
HEROIN
OXYCODONE
MORPHINE
HYDROCODONE
METHADONE
CODEINE
HYDROMORPHONE
DIHYDROCODEINE
MORPHINE SULFATE
OPIUM
VICODIN
*/
data opiate3;
   set opiate2;
   where drugword in (
      'HEROIN',
      'OXYCODONE',
      'MORPHINE',
      'HYDROCODONE',
      'METHADONE',
      'CODEINE',
      'HYDROMORPHONE',
      'DIHYDROCODEINE',
      'MORPHINE SULFATE',
      'OPIUM',
      'VICODIN'
      );
run;
proc sort data=opiate3 out=opiate4 nodupkey;
   by certno;
run;   
/*
Here's what I get:
NOTE: There were 890 observations read from the data set WORK.OPIATE3.
NOTE: 214 observations with duplicate key values were deleted.
NOTE: The data set WORK.OPIATE4 has 676 observations and 93 variables.

indicating 676 of 1240 opiate certificates also mentioned a specific opiate
*/

proc freq data=GenericLong noprint;
   where prescrip_flag = 'Y';
   tables drugword_cat*drugword/out=plist;
   format drugword $generic.;
run;
proc sort data=plist;
   by drugword_cat descending count;
run;
proc print data=plist uniform;
   by drugword_cat;
run;
proc sort data=plist;
   by descending count;
run;
proc print data=plist uniform;
run;

proc freq data=GenericLong noprint;
   where illicit_flag = 'Y';
   tables drugword_cat*drugword/out=ilist;
   format drugword $generic.;
run;
proc sort data=ilist;
   by drugword_cat descending count;
run;
proc print data=ilist uniform;
   by drugword_cat;
run;
proc sort data=ilist;
   by descending count;
run;
proc print data=ilist uniform;
run;

proc freq data=GenericLong noprint;
   where either_flag = 'Y';
   tables drugword_cat*drugword/out=elist;
   format drugword $generic.;
run;
proc sort data=elist;
   by descending count;
run;
proc print data=elist uniform;
run;

\end{lstlisting}

\bfs
\bvm
All deaths:

            Obs    drugword                        COUNT    PERCENT

              1    c-DRUG                           3792    14.7211
              2    g-METHADONE                      2149     8.3427
              3    c-MEDICATION                     1480     5.7456
              4    c-ALCOHOL                        1446     5.6136
              5    c-OPIATE                         1240     4.8139
              6    g-COCAINE                        1174     4.5576
              7    g-OXYCODONE                      1047     4.0646
              8    c-PRESCRIPTION                    694     2.6942
              9    c-METHAMPHETAMINE                 681     2.6437
             10    g-MORPHINE                        648     2.5156
             11    g-DIPHENHYDRAMINE                 574     2.2283
             12    g-HYDROCODONE                     563     2.1856
             13    c-HEROIN                          539     2.0925
             14    g-CITALOPRAM                      533     2.0692
             15    g-DIAZEPAM                        468     1.8168
             16    g-ALPRAZOLAM                      412     1.5994
             17    g-AMITRIPTYLINE                   397     1.5412
             18    g-ACETAMINOPHEN                   395     1.5334
             19    c-CARBON MONOXIDE                 394     1.5296
             20    g-HYDROMORPHONE                   269     1.0443
             21    g-FLUOXETINE                      243     0.9434
             22    g-TRAZODONE                       227     0.8812
             23    g-CYCLOBENZAPRINE                 220     0.8541
             24    g-VENLAFAXINE                     220     0.8541
             25    g-QUETIAPINE                      199     0.7725
             26    g-FENTANYL                        198     0.7687
             27    g-SERTRALINE                      192     0.7454
             28    c-ALCOHOLISM                      182     0.7065
             29    g-BUPROPION                       169     0.6561
             30    g-BENZODIAZEPINE                  163     0.6328
             31    c-VEHICLE EXHAUST                 158     0.6134
             32    g-TRAMADOL                        153     0.5940
             33    g-GABAPENTIN                      152     0.5901
             34    g-CODEINE                         148     0.5746
             35    g-ZOLPIDEM                        145     0.5629
             36    g-DOXEPIN                         143     0.5551
             37    g-NORTRIPTYLINE                   143     0.5551
             38    g-PROPOXYPHENE                    141     0.5474
             39    g-CARISOPRODOL                    139     0.5396
             40    g-DEXTROMETHORPHAN                139     0.5396
             41    g-PAROXETINE                      137     0.5319
             42    g-MIRTAZEPINE                     130     0.5047
             43    g-MEPROBAMATE                     122     0.4736
             44    g-CLONAZEPAM                      120     0.4659
             45    g-TEMAZEPAM                       114     0.4426
             46    g-PROMETHAZINE                    113     0.4387
             47    g-LORAZEPAM                       109     0.4232
             48    c-FUMES                           106     0.4115
             49    g-DOXYLAMINE                       94     0.3649
             50    g-HYDROXYZINE                      79     0.3067
             51    g-OLANZAPINE                       73     0.2834
             52    c-POLYPHARMACEUTICAL               65     0.2523
             53    g-TOPIRAMATE                       64     0.2485
             54    c-AMPHETAMINE                      63     0.2446
             55    c-PHARMACEUTICAL                   56     0.2174
             56    c-NARCOTIC                         55     0.2135
             57    g-LAMOTRIGINE                      54     0.2096
             58    c-POLYDRUG                         52     0.2019
             59    g-SALICYLATE                       51     0.1980
             60    g-BUTALBITAL                       47     0.1825
             61    g-CHLORDIAZEPOXIDE                 45     0.1747
             62    g-CARBAMAZEPINE                    42     0.1630
             63    g-DILTIAZEM                        42     0.1630
             64    g-IBUPROFEN                        42     0.1630
             65    g-NORDIAZEPAM                      39     0.1514
             66    c-HELIUM                           37     0.1436
             67    g-MEPERIDINE                       36     0.1398
             68    g-PHENOBARBITAL                    36     0.1398
             69    g-OXAZEPAM                         35     0.1359
             70    g-METHOCARBAMOL                    34     0.1320
             71    g-VALPROIC ACID                    34     0.1320
             72    g-CHLORPHENIRAMINE                 33     0.1281
             73    g-IMIPRAMINE                       32     0.1242
             74    g-VERAPAMIL                        32     0.1242
             75    g-INSULIN                          31     0.1203
             76    c-CANNABINOID                      30     0.1165
             77    c-ETHYLENE                         30     0.1165
             78    c-GLYCOL                           30     0.1165
             79    c-PILL                             29     0.1126
             80    c-ANTIDEPRESSANT                   28     0.1087
             81    c-ENGINE EXHAUST                   28     0.1087
             82    c-NARCOTISM                        28     0.1087
             83    c-MDMA                             25     0.0971
             84    g-PHENYTOIN                        24     0.0932
             85    c-POLYSUBSTANCE                    24     0.0932
             86    c-PRODUCTS OF COMBUSTION           23     0.0893
             87    c-SMOKE INHALATION                 20     0.0776
             88    c-PROPANE                          19     0.0738
             89    g-METHYLPHENIDATE                  17     0.0660
             90    c-DEPRESSANT                       16     0.0621
             91    c-DIFLUOROETHANE                   16     0.0621
             92    g-METOCLOPRAMIDE                   16     0.0621
             93    g-WARFARIN                         15     0.0582
             94    g-NAPROXEN                         15     0.0582
             95    g-GUAIFENESIN                      14     0.0543
             96    g-LITHIUM                          14     0.0543
             97    c-POLYMEDICATION                   14     0.0543
             98    g-PSEUDOEPHEDRINE                  14     0.0543
             99    g-AMIODARONE                       13     0.0505
            100    g-BUPIVACAINE                      12     0.0466
            101    g-CLOMIPRAMINE                     12     0.0466
            102    g-CLOZAPINE                        12     0.0466
            103    g-FLURAZEPAM                       12     0.0466
            104    g-OXCARBAZEPINE                    12     0.0466
            105    c-TRANQUILIZER                     12     0.0466
            106    c-ANTIFREEZE                       11     0.0427
            107    c-COCAETHYLENE                     11     0.0427
            108    g-DESIPRAMINE                      11     0.0427
            109    g-ASPIRIN                          10     0.0388
            110    g-BUSPIRONE                        10     0.0388
            111    c-CHEMICAL                         10     0.0388
            112    c-ISOPROPANOL                      10     0.0388
            113    g-MIDAZOLAM                        10     0.0388
            114    c-TRICYCLIC                        10     0.0388
            115    g-ANTIPYRINE                        9     0.0349
            116    g-BLEOMYCIN                         9     0.0349
            117    c-CAFFEINE                          9     0.0349
            118    g-NORFLUOXETINE                     9     0.0349
            119    g-PROPRANOLOL                       9     0.0349
            120    c-TABLETS                           8     0.0311
            121    c-BARBITURATE                       7     0.0272
            122    g-LEVETIRACETAM                     7     0.0272



Prescription drug users (prescrip_flag = 'Y')

                                 The SAS System                                8
                                                    11:02 Thursday, July 5, 2012

------------------------------- drugword_cat=OTC -------------------------------

              Obs    drugword                     COUNT    PERCENT

                1    g-ACETAMINOPHEN                321     1.5169
                2    g-IBUPROFEN                     38     0.1796
                3    g-SALICYLATE                    27     0.1276
                4    g-NAPROXEN                      13     0.0614
                5    g-ASPIRIN                        2     0.0095
                6    c-ANTIFUNGAL                     1     0.0047
                7    c-ANTIHISTAMINE                  1     0.0047
                8    c-OTC                            1     0.0047
                9    c-PHENETHYLAMINE                 1     0.0047


----------------------------- drugword_cat=alcohol -----------------------------

              Obs    drugword                     COUNT    PERCENT

               10    c-ALCOHOL                     1002     4.7351
               11    c-BEER                           1     0.0047


----------------------------- drugword_cat=common ------------------------------

              Obs    drugword                     COUNT    PERCENT

               12    c-CARBON MONOXIDE               14     0.0662
               13    c-CAFFEINE                       7     0.0331
               14    c-VEHICLE EXHAUST                6     0.0284
               15    c-ETHYLENE                       4     0.0189
               16    c-FUMES                          4     0.0189
               17    c-GLYCOL                         4     0.0189
               18    c-NICOTINE                       4     0.0189
               19    c-ISOPROPANOL                    3     0.0142
               20    c-ENGINE EXHAUST                 2     0.0095
               21    c-HELIUM                         2     0.0095
               22    c-METHANOL                       2     0.0095
               23    c-SMOKE INHALATION               2     0.0095
               24    c-TOBACCO                        2     0.0095
               25    c-ANTIFREEZE                     1     0.0047
               26    c-CHLOROBENZALDEHYDE             1     0.0047
               27    c-CIGARETTE                      1     0.0047
               28    c-COTININE                       1     0.0047
               29    c-DICHLOROMETHANE                1     0.0047
               30    c-DIETHYLETHER                   1     0.0047
               31    c-DIFLUOROETHANE                 1     0.0047
               32    c-ETHER                          1     0.0047
               33    c-ETHYLENE GLYCOL                1     0.0047
               34    c-GAMMA HYDROXYBUTYRATE          1     0.0047
               35    c-HYDROGEN CHLORIDE              1     0.0047
               36    c-HYDROGEN SULFIDE               1     0.0047
               37    c-ISOPROPYL ALCOHOL              1     0.0047
               38    c-METHANE                        1     0.0047
               39    ?-NITROUS AND                    1     0.0047
               40    c-NITROUS OXIDE                  1     0.0047
               41    c-POPPY                          1     0.0047


----------------------------- drugword_cat=disease -----------------------------

              Obs    drugword                     COUNT    PERCENT

               42    c-ALCOHOLISM                    96     0.4537
               43    c-NARCOTISM                      4     0.0189
               44    c-ANTICOAGULATION                1     0.0047


----------------------------- drugword_cat=either ------------------------------

              Obs    drugword                     COUNT    PERCENT

               45    c-OPIATE                       729     3.4450
               46    c-STIMULANT                      3     0.0142


----------------------------- drugword_cat=illicit -----------------------------

              Obs    drugword                     COUNT    PERCENT

               47    g-COCAINE                      652     3.0811
               48    c-METHAMPHETAMINE              292     1.3799
               49    c-HEROIN                       168     0.7939
               50    c-CANNABINOID                   29     0.1370
               51    c-MDMA                          14     0.0662
               52    c-COCAETHYLENE                   8     0.0378
               53    c-PHENCYCLIDINE                  4     0.0189
               54    c-MARIJUANA                      3     0.0142
               55    c-METHYLENEDIOXY                 1     0.0047
               56    c-OPIUM                          1     0.0047


--------------------------- drugword_cat=nonspecific ---------------------------

              Obs    drugword                     COUNT    PERCENT

               57    c-DRUG                        2893    13.6714
               58    c-MEDICATION                  1377     6.5073
               59    c-PRESCRIPTION                 623     2.9441
               60    c-POLYPHARMACEUTICAL            59     0.2788
               61    c-PHARMACEUTICAL                55     0.2599
               62    c-NARCOTIC                      37     0.1748
               63    c-POLYDRUG                      26     0.1229
               64    c-ANTIDEPRESSANT                21     0.0992
               65    c-PILL                          21     0.0992
               66    c-POLYSUBSTANCE                 14     0.0662
               67    c-POLYMEDICATION                 7     0.0331
               68    c-TABLETS                        4     0.0189
               69    c-ANESTHETIC                     3     0.0142
               70    c-POLYPRESCRIPTION               3     0.0142
               71    c-ANTIBODY                       2     0.0095
               72    c-ANTIPHOSPHOLIPID               2     0.0095
               73    c-POLYPHARMACY                   2     0.0095
               74    c-ANALGESIC                      1     0.0047
               75    c-ANESTHESIA                     1     0.0047
               76    c-CHEMICAL                       1     0.0047
               77    c-PAIN RELIEVER                  1     0.0047
               78    c-SEDATION                       1     0.0047
               79    c-SEDATIVE                       1     0.0047


-------------------------- drugword_cat=prescription ---------------------------

              Obs    drugword                     COUNT    PERCENT

               80    g-METHADONE                   2149    10.1555
               81    g-OXYCODONE                   1047     4.9478
               82    g-MORPHINE                     648     3.0622
               83    g-DIPHENHYDRAMINE              574     2.7125
               84    g-HYDROCODONE                  563     2.6606
               85    g-CITALOPRAM                   533     2.5188
               86    g-DIAZEPAM                     468     2.2116
               87    g-ALPRAZOLAM                   412     1.9470
               88    g-AMITRIPTYLINE                397     1.8761
               89    g-HYDROMORPHONE                269     1.2712
               90    g-FLUOXETINE                   243     1.1483
               91    g-TRAZODONE                    227     1.0727
               92    g-CYCLOBENZAPRINE              220     1.0396
               93    g-VENLAFAXINE                  220     1.0396
               94    g-QUETIAPINE                   199     0.9404
               95    g-FENTANYL                     198     0.9357
               96    g-SERTRALINE                   192     0.9073
               97    g-BUPROPION                    169     0.7986
               98    g-BENZODIAZEPINE               163     0.7703
               99    g-TRAMADOL                     153     0.7230
              100    g-GABAPENTIN                   152     0.7183
              101    g-CODEINE                      148     0.6994
              102    g-ZOLPIDEM                     145     0.6852
              103    g-DOXEPIN                      143     0.6758
              104    g-NORTRIPTYLINE                143     0.6758
              105    g-PROPOXYPHENE                 141     0.6663
              106    g-CARISOPRODOL                 139     0.6569
              107    g-DEXTROMETHORPHAN             139     0.6569
              108    g-PAROXETINE                   137     0.6474
              109    g-MIRTAZEPINE                  130     0.6143
              110    g-MEPROBAMATE                  122     0.5765
              111    g-CLONAZEPAM                   120     0.5671
              112    g-TEMAZEPAM                    114     0.5387
              113    g-PROMETHAZINE                 113     0.5340
              114    g-LORAZEPAM                    109     0.5151
              115    g-DOXYLAMINE                    94     0.4442
              116    g-HYDROXYZINE                   79     0.3733
              117    g-OLANZAPINE                    73     0.3450
              118    g-TOPIRAMATE                    64     0.3024
              119    c-AMPHETAMINE                   63     0.2977
              120    g-LAMOTRIGINE                   54     0.2552
              121    g-BUTALBITAL                    47     0.2221
              122    g-CHLORDIAZEPOXIDE              45     0.2127
              123    g-CARBAMAZEPINE                 42     0.1985
              124    g-DILTIAZEM                     42     0.1985
              125    g-NORDIAZEPAM                   39     0.1843
              126    g-MEPERIDINE                    36     0.1701
              127    g-PHENOBARBITAL                 36     0.1701
              128    g-OXAZEPAM                      35     0.1654
              129    g-METHOCARBAMOL                 34     0.1607
              130    g-VALPROIC ACID                 34     0.1607
              131    g-CHLORPHENIRAMINE              33     0.1559
              132    g-IMIPRAMINE                    32     0.1512
              133    g-VERAPAMIL                     32     0.1512
              134    g-INSULIN                       31     0.1465
              135    g-PHENYTOIN                     24     0.1134
              136    g-METHYLPHENIDATE               17     0.0803
              137    c-DEPRESSANT                    16     0.0756
              138    g-METOCLOPRAMIDE                16     0.0756
              139    g-WARFARIN                      15     0.0709
              140    g-GUAIFENESIN                   14     0.0662
              141    g-LITHIUM                       14     0.0662
              142    g-PSEUDOEPHEDRINE               14     0.0662
              143    g-AMIODARONE                    13     0.0614
              144    g-BUPIVACAINE                   12     0.0567
              145    g-CLOMIPRAMINE                  12     0.0567
              146    g-CLOZAPINE                     12     0.0567
              147    g-FLURAZEPAM                    12     0.0567
              148    g-OXCARBAZEPINE                 12     0.0567
              149    c-TRANQUILIZER                  12     0.0567
              150    g-DESIPRAMINE                   11     0.0520
              151    g-BUSPIRONE                     10     0.0473
              152    g-MIDAZOLAM                     10     0.0473
              153    c-TRICYCLIC                     10     0.0473


----------------------------- drugword_cat=unknown -----------------------------

              Obs    drugword                     COUNT    PERCENT

              264    ?-DIPHENHY                       1     0.0047
              265    ?-DIPHENYL                       1     0.0047
              266    ?-PSLOET                         1     0.0047
              267    ?-TRAZADIBEM                     1     0.0047



Illicit drug users (illicit_flag = 'Y')

                                 The SAS System                               19
                                                    11:02 Thursday, July 5, 2012

------------------------------- drugword_cat=OTC -------------------------------

              Obs    drugword                    COUNT    PERCENT

                1    g-ACETAMINOPHEN                25     0.3443
                2    g-IBUPROFEN                     3     0.0413
                3    g-NAPROXEN                      3     0.0413
                4    g-SALICYLATE                    2     0.0275


----------------------------- drugword_cat=alcohol -----------------------------

              Obs    drugword                    COUNT    PERCENT

                5    c-ALCOHOL                     382     5.2610
                6    c-BEER                          1     0.0138


----------------------------- drugword_cat=common ------------------------------

              Obs    drugword                    COUNT    PERCENT

                7    c-CARBON MONOXIDE              11     0.1515
                8    c-VEHICLE EXHAUST               3     0.0413
                9    c-FUMES                         3     0.0413
               10    c-TOBACCO                       2     0.0275
               11    c-CAFFEINE                      1     0.0138
               12    c-DIETHYLETHER                  1     0.0138
               13    c-ETHER                         1     0.0138
               14    c-ISOPROPANOL                   1     0.0138
               15    c-METHANOL                      1     0.0138
               16    c-NICOTINE                      1     0.0138
               17    c-PRODUCTS OF COMBUSTION        1     0.0138


----------------------------- drugword_cat=disease -----------------------------

              Obs    drugword                    COUNT    PERCENT

               18    c-NARCOTISM                    25     0.3443
               19    c-ALCOHOLISM                   23     0.3168


----------------------------- drugword_cat=either ------------------------------

              Obs    drugword                    COUNT    PERCENT

               20    c-OPIATE                      586     8.0705
               21    c-STIMULANT                     3     0.0413


----------------------------- drugword_cat=illicit -----------------------------

              Obs    drugword                    COUNT    PERCENT

               22    g-COCAINE                    1174    16.1686
               23    c-METHAMPHETAMINE             681     9.3789
               24    c-HEROIN                      539     7.4232
               25    c-CANNABINOID                  30     0.4132
               26    c-MDMA                         25     0.3443
               27    c-COCAETHYLENE                 11     0.1515
               28    c-MARIJUANA                     7     0.0964
               29    c-PHENCYCLIDINE                 7     0.0964
               30    c-METHYLENEDIOXY                1     0.0138
               31    c-OPIUM                         1     0.0138
               32    c-TETRAHYDROCANNABINOL          1     0.0138


--------------------------- drugword_cat=nonspecific ---------------------------

              Obs    drugword                    COUNT    PERCENT

               33    c-DRUG                       1379    18.9919
               34    c-MEDICATION                  100     1.3772
               35    c-PRESCRIPTION                 66     0.9090
               36    c-POLYDRUG                     16     0.2204
               37    c-NARCOTIC                      9     0.1239
               38    c-POLYSUBSTANCE                 9     0.1239
               39    c-ANTIDEPRESSANT                5     0.0689
               40    c-PHARMACEUTICAL                3     0.0413
               41    c-PILL                          3     0.0413
               42    c-POLYPHARMACEUTICAL            3     0.0413
               43    c-ANESTHETIC                    2     0.0275
               44    c-POLYMEDICATION                2     0.0275
               45    c-POLYPRESCRIPTION              2     0.0275
               46    c-ANESTHESIA                    1     0.0138
               47    c-SEDATIVE                      1     0.0138


-------------------------- drugword_cat=prescription ---------------------------

              Obs    drugword                    COUNT    PERCENT

               48    g-METHADONE                   454     6.2526
               49    g-OXYCODONE                   162     2.2311
               50    g-MORPHINE                    140     1.9281
               51    g-DIAZEPAM                     97     1.3359
               52    g-DIPHENHYDRAMINE              90     1.2395
               53    g-CITALOPRAM                   88     1.2120
               54    g-ALPRAZOLAM                   73     1.0054
               55    g-AMITRIPTYLINE                69     0.9503
               56    g-HYDROCODONE                  66     0.9090
               57    g-HYDROMORPHONE                46     0.6335
               58    g-BENZODIAZEPINE               38     0.5233
               59    g-DEXTROMETHORPHAN             38     0.5233
               60    g-VENLAFAXINE                  38     0.5233
               61    g-SERTRALINE                   35     0.4820
               62    g-TRAZODONE                    35     0.4820
               63    g-CYCLOBENZAPRINE              34     0.4683
               64    g-FLUOXETINE                   32     0.4407
               65    g-CODEINE                      30     0.4132
               66    g-NORTRIPTYLINE                30     0.4132
               67    c-AMPHETAMINE                  29     0.3994
               68    g-PAROXETINE                   28     0.3856
               69    g-DOXEPIN                      27     0.3718
               70    g-QUETIAPINE                   26     0.3581
               71    g-GABAPENTIN                   24     0.3305
               72    g-MEPROBAMATE                  23     0.3168
               73    g-BUPROPION                    21     0.2892
               74    g-PROMETHAZINE                 19     0.2617
               75    g-CARISOPRODOL                 18     0.2479
               76    g-MIRTAZEPINE                  18     0.2479
               77    g-CLONAZEPAM                   16     0.2204
               78    g-DILTIAZEM                    16     0.2204
               79    g-DOXYLAMINE                   16     0.2204
               80    g-TRAMADOL                     16     0.2204
               81    g-FENTANYL                     15     0.2066
               82    g-HYDROXYZINE                  14     0.1928
               83    g-LORAZEPAM                    14     0.1928
               84    g-PROPOXYPHENE                 12     0.1653
               85    g-TEMAZEPAM                    10     0.1377


----------------------------- drugword_cat=unknown -----------------------------

              Obs    drugword                    COUNT    PERCENT

              141    ?-DIPHENHY                      1     0.0138
              142    ?-PSLOET                        1     0.0138
              143    ?-TRAZADIBEM                    1     0.0138



Prescription drug users (not grouped)
                                 The SAS System                               23
                                                    11:02 Thursday, July 5, 2012

      Obs    drugword_cat    drugword                     COUNT    PERCENT

        1    nonspecific     c-DRUG                        2893    13.6714
        2    prescription    g-METHADONE                   2149    10.1555
        3    nonspecific     c-MEDICATION                  1377     6.5073
        4    prescription    g-OXYCODONE                   1047     4.9478
        5    alcohol         c-ALCOHOL                     1002     4.7351
        6    either          c-OPIATE                       729     3.4450
        7    illicit         g-COCAINE                      652     3.0811
        8    prescription    g-MORPHINE                     648     3.0622
        9    nonspecific     c-PRESCRIPTION                 623     2.9441
       10    prescription    g-DIPHENHYDRAMINE              574     2.7125
       11    prescription    g-HYDROCODONE                  563     2.6606
       12    prescription    g-CITALOPRAM                   533     2.5188
       13    prescription    g-DIAZEPAM                     468     2.2116
       14    prescription    g-ALPRAZOLAM                   412     1.9470
       15    prescription    g-AMITRIPTYLINE                397     1.8761
       16    OTC             g-ACETAMINOPHEN                321     1.5169
       17    illicit         c-METHAMPHETAMINE              292     1.3799
       18    prescription    g-HYDROMORPHONE                269     1.2712
       19    prescription    g-FLUOXETINE                   243     1.1483
       20    prescription    g-TRAZODONE                    227     1.0727
       21    prescription    g-CYCLOBENZAPRINE              220     1.0396
       22    prescription    g-VENLAFAXINE                  220     1.0396
       23    prescription    g-QUETIAPINE                   199     0.9404
       24    prescription    g-FENTANYL                     198     0.9357
       25    prescription    g-SERTRALINE                   192     0.9073
       26    prescription    g-BUPROPION                    169     0.7986
       27    illicit         c-HEROIN                       168     0.7939
       28    prescription    g-BENZODIAZEPINE               163     0.7703
       29    prescription    g-TRAMADOL                     153     0.7230
       30    prescription    g-GABAPENTIN                   152     0.7183
       31    prescription    g-CODEINE                      148     0.6994
       32    prescription    g-ZOLPIDEM                     145     0.6852
       33    prescription    g-DOXEPIN                      143     0.6758
       34    prescription    g-NORTRIPTYLINE                143     0.6758
       35    prescription    g-PROPOXYPHENE                 141     0.6663
       36    prescription    g-CARISOPRODOL                 139     0.6569
       37    prescription    g-DEXTROMETHORPHAN             139     0.6569
       38    prescription    g-PAROXETINE                   137     0.6474
       39    prescription    g-MIRTAZEPINE                  130     0.6143
       40    prescription    g-MEPROBAMATE                  122     0.5765
       41    prescription    g-CLONAZEPAM                   120     0.5671
       42    prescription    g-TEMAZEPAM                    114     0.5387
       43    prescription    g-PROMETHAZINE                 113     0.5340
       44    prescription    g-LORAZEPAM                    109     0.5151
       45    disease         c-ALCOHOLISM                    96     0.4537
       46    prescription    g-DOXYLAMINE                    94     0.4442
       47    prescription    g-HYDROXYZINE                   79     0.3733
       48    prescription    g-OLANZAPINE                    73     0.3450
       49    prescription    g-TOPIRAMATE                    64     0.3024
       50    prescription    c-AMPHETAMINE                   63     0.2977
       51    nonspecific     c-POLYPHARMACEUTICAL            59     0.2788
       52    nonspecific     c-PHARMACEUTICAL                55     0.2599
       53    prescription    g-LAMOTRIGINE                   54     0.2552
       54    prescription    g-BUTALBITAL                    47     0.2221
       55    prescription    g-CHLORDIAZEPOXIDE              45     0.2127
       56    prescription    g-CARBAMAZEPINE                 42     0.1985
       57    prescription    g-DILTIAZEM                     42     0.1985
       58    prescription    g-NORDIAZEPAM                   39     0.1843
       59    OTC             g-IBUPROFEN                     38     0.1796
       60    nonspecific     c-NARCOTIC                      37     0.1748
       61    prescription    g-MEPERIDINE                    36     0.1701


Illicit drug users (not grouped)
                                 The SAS System                               28
                                                    11:02 Thursday, July 5, 2012

      Obs    drugword_cat    drugword                    COUNT    PERCENT

        1    nonspecific     c-DRUG                       1379    18.9919
        2    illicit         g-COCAINE                    1174    16.1686
        3    illicit         c-METHAMPHETAMINE             681     9.3789
        4    either          c-OPIATE                      586     8.0705
        5    illicit         c-HEROIN                      539     7.4232
        6    prescription    g-METHADONE                   454     6.2526
        7    alcohol         c-ALCOHOL                     382     5.2610
        8    prescription    g-OXYCODONE                   162     2.2311
        9    prescription    g-MORPHINE                    140     1.9281
       10    nonspecific     c-MEDICATION                  100     1.3772
       11    prescription    g-DIAZEPAM                     97     1.3359
       12    prescription    g-DIPHENHYDRAMINE              90     1.2395
       13    prescription    g-CITALOPRAM                   88     1.2120
       14    prescription    g-ALPRAZOLAM                   73     1.0054
       15    prescription    g-AMITRIPTYLINE                69     0.9503
       16    nonspecific     c-PRESCRIPTION                 66     0.9090
       17    prescription    g-HYDROCODONE                  66     0.9090
       18    prescription    g-HYDROMORPHONE                46     0.6335
       19    prescription    g-BENZODIAZEPINE               38     0.5233
       20    prescription    g-DEXTROMETHORPHAN             38     0.5233
       21    prescription    g-VENLAFAXINE                  38     0.5233
       22    prescription    g-SERTRALINE                   35     0.4820
       23    prescription    g-TRAZODONE                    35     0.4820
       24    prescription    g-CYCLOBENZAPRINE              34     0.4683
       25    prescription    g-FLUOXETINE                   32     0.4407
       26    illicit         c-CANNABINOID                  30     0.4132
       27    prescription    g-CODEINE                      30     0.4132
       28    prescription    g-NORTRIPTYLINE                30     0.4132
       29    prescription    c-AMPHETAMINE                  29     0.3994
       30    prescription    g-PAROXETINE                   28     0.3856
       31    prescription    g-DOXEPIN                      27     0.3718
       32    prescription    g-QUETIAPINE                   26     0.3581
       33    OTC             g-ACETAMINOPHEN                25     0.3443
       34    disease         c-NARCOTISM                    25     0.3443
       35    illicit         c-MDMA                         25     0.3443
       36    prescription    g-GABAPENTIN                   24     0.3305
       37    disease         c-ALCOHOLISM                   23     0.3168
       38    prescription    g-MEPROBAMATE                  23     0.3168
       39    prescription    g-BUPROPION                    21     0.2892
       40    prescription    g-PROMETHAZINE                 19     0.2617
       41    prescription    g-CARISOPRODOL                 18     0.2479
       42    prescription    g-MIRTAZEPINE                  18     0.2479
       43    nonspecific     c-POLYDRUG                     16     0.2204
       44    prescription    g-CLONAZEPAM                   16     0.2204
       45    prescription    g-DILTIAZEM                    16     0.2204
       46    prescription    g-DOXYLAMINE                   16     0.2204
       47    prescription    g-TRAMADOL                     16     0.2204
       48    prescription    g-FENTANYL                     15     0.2066
       49    prescription    g-HYDROXYZINE                  14     0.1928
       50    prescription    g-LORAZEPAM                    14     0.1928
       51    prescription    g-PROPOXYPHENE                 12     0.1653
       52    common          c-CARBON MONOXIDE              11     0.1515
       53    illicit         c-COCAETHYLENE                 11     0.1515
       54    prescription    g-TEMAZEPAM                    10     0.1377
       55    nonspecific     c-NARCOTIC                      9     0.1239
       56    nonspecific     c-POLYSUBSTANCE                 9     0.1239
       57    prescription    g-CHLORDIAZEPOXIDE              9     0.1239
       58    prescription    g-OLANZAPINE                    9     0.1239
       59    prescription    g-ZOLPIDEM                      9     0.1239
       60    prescription    g-NORDIAZEPAM                   8     0.1102
       61    illicit         c-MARIJUANA                     7     0.0964


Deaths where a drug in the "either" class was mentioned
                                 The SAS System                               31
                                                    11:02 Thursday, July 5, 2012

        Obs    drugword_cat    drugword                COUNT    PERCENT

          1    either          c-OPIATE                 1240    24.9899
          2    nonspecific     c-DRUG                    743    14.9738
          3    illicit         g-COCAINE                 334     6.7312
          4    alcohol         c-ALCOHOL                 299     6.0258
          5    illicit         c-HEROIN                  265     5.3406
          6    prescription    g-MORPHINE                206     4.1516
          7    prescription    g-METHADONE               164     3.3051
          8    nonspecific     c-MEDICATION              104     2.0959
          9    prescription    g-OXYCODONE               100     2.0153
         10    nonspecific     c-PRESCRIPTION             96     1.9347
         11    illicit         c-METHAMPHETAMINE          93     1.8742
         12    prescription    g-CITALOPRAM               84     1.6929
         13    prescription    g-HYDROMORPHONE            70     1.4107
         14    prescription    g-DIAZEPAM                 69     1.3906
         15    prescription    g-DIPHENHYDRAMINE          62     1.2495
         16    prescription    g-HYDROCODONE              52     1.0480
         17    prescription    g-AMITRIPTYLINE            51     1.0278
         18    prescription    g-ALPRAZOLAM               49     0.9875
         19    prescription    g-BENZODIAZEPINE           47     0.9472
         20    prescription    g-TRAZODONE                46     0.9270
         21    prescription    g-CODEINE                  33     0.6651
         22    prescription    g-VENLAFAXINE              32     0.6449
         23    nonspecific     c-PHARMACEUTICAL           31     0.6247
         24    prescription    g-SERTRALINE               29     0.5844
         25    disease         c-ALCOHOLISM               27     0.5441
         26    prescription    g-FLUOXETINE               27     0.5441
         27    prescription    g-DEXTROMETHORPHAN         25     0.5038
         28    OTC             g-ACETAMINOPHEN            23     0.4635
         29    prescription    g-PAROXETINE               23     0.4635
         30    prescription    g-GABAPENTIN               20     0.4031
         31    prescription    g-MEPROBAMATE              20     0.4031
         32    prescription    g-BUPROPION                19     0.3829
         33    prescription    g-CYCLOBENZAPRINE          19     0.3829
         34    prescription    g-PROMETHAZINE             18     0.3628
         35    nonspecific     c-NARCOTIC                 16     0.3225
         36    prescription    g-DOXEPIN                  16     0.3225
         37    prescription    g-CARISOPRODOL             15     0.3023
         38    prescription    g-MIRTAZEPINE              15     0.3023
         39    prescription    g-TRAMADOL                 15     0.3023
         40    prescription    c-AMPHETAMINE              14     0.2821
         41    prescription    g-CHLORDIAZEPOXIDE         14     0.2821
         42    prescription    g-DOXYLAMINE               14     0.2821
         43    prescription    g-LORAZEPAM                14     0.2821
         44    prescription    g-QUETIAPINE               13     0.2620
         45    prescription    g-TEMAZEPAM                13     0.2620
         46    prescription    g-CLONAZEPAM               12     0.2418
         47    prescription    g-NORTRIPTYLINE            12     0.2418
         48    prescription    g-OLANZAPINE               12     0.2418
         49    prescription    g-TOPIRAMATE               12     0.2418
         50    prescription    g-FENTANYL                 11     0.2217
         51    prescription    g-PROPOXYPHENE             11     0.2217
         52    nonspecific     c-ANTIDEPRESSANT           10     0.2015
         53    nonspecific     c-POLYDRUG                 10     0.2015
         54    prescription    g-ZOLPIDEM                  9     0.1814
         55    prescription    g-HYDROXYZINE               8     0.1612
         56    prescription    g-MEPERIDINE                8     0.1612
         57    prescription    g-BUTALBITAL                7     0.1411
         58    prescription    g-DILTIAZEM                 7     0.1411
         59    prescription    g-PHENOBARBITAL             7     0.1411
         60    prescription    c-TRANQUILIZER              7     0.1411
         61    nonspecific     c-POLYMEDICATION            6     0.1209
\end{verbatim}
\efs

\begin{lstlisting}[language=sas,caption=Number of decedents in each category]
proc freq data=sm.TcodeWide;
   where st_res = '48' and 'X40' le underly3 le 'Y19';
   tables prescrip_flag illicit_flag either_flag alcohol_flag common_flag disease_flag
      nonspec_flag otc_flag unknown_flag;

   tables either_flag*prescrip_flag*illicit_flag/norow nocol nopercent;
run;
\end{lstlisting}


\bfs
\bvm
   The SAS System                                     14:59 Thursday, May 2, 2013   4

                            The FREQ Procedure

      prescrip_                             Cumulative    Cumulative
      flag         Frequency     Percent     Frequency      Percent
      --------------------------------------------------------------
      N                2363       30.23          2363        30.23
      Y                5454       69.77          7817       100.00


      illicit_                             Cumulative    Cumulative
      flag        Frequency     Percent     Frequency      Percent
      -------------------------------------------------------------
      N               5655       72.34          5655        72.34
      Y               2162       27.66          7817       100.00


      either_                             Cumulative    Cumulative
      flag       Frequency     Percent     Frequency      Percent
      ------------------------------------------------------------
      N              6573       84.09          6573        84.09
      Y              1244       15.91          7817       100.00


      alcohol_                             Cumulative    Cumulative
      flag        Frequency     Percent     Frequency      Percent
      -------------------------------------------------------------
      N               6371       81.50          6371        81.50
      Y               1446       18.50          7817       100.00


      common_                             Cumulative    Cumulative
      flag       Frequency     Percent     Frequency      Percent
      ------------------------------------------------------------
      N              7165       91.66          7165        91.66
      Y               652        8.34          7817       100.00


      disease_                             Cumulative    Cumulative
      flag        Frequency     Percent     Frequency      Percent
      -------------------------------------------------------------
      N               7606       97.30          7606        97.30
      Y                211        2.70          7817       100.00


      nonspec_                             Cumulative    Cumulative
      flag        Frequency     Percent     Frequency      Percent
      -------------------------------------------------------------
      N               2866       36.66          2866        36.66
      Y               4951       63.34          7817       100.00


                                           Cumulative    Cumulative
      otc_flag    Frequency     Percent     Frequency      Percent
      -------------------------------------------------------------
      N               7348       94.00          7348        94.00
      Y                469        6.00          7817       100.00


      unknown_                             Cumulative    Cumulative
      flag        Frequency     Percent     Frequency      Percent
      -------------------------------------------------------------
      N               7811       99.92          7811        99.92
      Y                  6        0.08          7817       100.00



      The SAS System                                     14:59 Thursday, May 2, 2013   6

                            The FREQ Procedure

                 Table 1 of prescrip_flag by illicit_flag
                      Controlling for either_flag=N

                   prescrip_flag     illicit_flag

                   Frequency|N       |Y       |  Total
                   ---------+--------+--------+
                   N        |   1037 |    814 |   1851
                   ---------+--------+--------+
                   Y        |   3963 |    759 |   4722
                   ---------+--------+--------+
                   Total        5000     1573     6573


                 Table 2 of prescrip_flag by illicit_flag
                      Controlling for either_flag=Y

                   prescrip_flag     illicit_flag

                   Frequency|N       |Y       |  Total
                   ---------+--------+--------+
                   N        |    198 |    314 |    512
                   ---------+--------+--------+
                   Y        |    457 |    275 |    732
                   ---------+--------+--------+
                   Total         655      589     1244

\end{verbatim}
\efs

\end{detail}

There were 7,859 poisoning deaths among Washington State residents during
2003--2010. These included 5,850 unintentional deaths, 1,461 suicides, 11
homicides, 495 deaths of undetermined intent, and 42 deaths caused by complications of
medical or surgical care. This analysis excludes the 42 deaths related to medical 
care. 

Methadone was mentioned on more of these death certificates (2,149) than any other substance, followed by alcohol, opiate, cocaine, and oxycodone (see \autoref{allnames}).  The only illicit drugs named among the top 25 substances were cocaine, methamphetamine, and heroin. Among pairs of substances that are co-mentioned on certificates, there are 4 substances that are named in all of the ten most frequently named pairs: methadone, alcohol, cocaine, and opiate (\autoref{pairs}). The word ``opiate'' was mentioned on 1,240 certificates, but more than half (676) of these certificates also named a specific opiate. 

Age-specific death rates for each of the 5 most commonly named substances showed similar age patterns among men and women, but women have lower rates for each of the substances except oxycodone, where the rates are similar between men and women (\autoref{plotbyage4}). The highest death rates are among men and women age 40--49, except among women the highest death rates for oxycodone and alcohol are at age 50--59. 

In Washington State, the rate of deaths in which methadone or cocaine were mentioned reached a peak in 2006 (\autoref{plotadjbyyear1}). Oxycodone deaths may have started to decline in Washington in 2009, and the methamphetamine death rate has remained fairly constant. The temporal pattern was similar between men and women, although, as noted above, women had lower death rates for each substance except oxycodone.

At least one prescription drug was named on 5,454 (70\%) of the poisoning deaths; at least one illicit drug on 2,162 (28\%); on an additional 198 (3\%) of deaths, a drug that could be either prescription or illict (e.g. ``opiate'') was named.
The death rates for deaths in which only prescription drugs were mentioned were 3--5 times higher than for deaths in which only illicit drugs or both illicit and prescription drugs were mentioned (\autoref{plotflagbyyear3}). Prescription drug death rates increased during the period 2003--2008, then began to fall, but illicit drug death rates remained constant during the entire period, suggesting that prescription drugs were not replacing illicit drugs. Prescription drug death rates were as high among women as among men, but women had lower death rates for deaths where only illicit drugs, both illicit and prescription drugs, or neither, were mentioned.

The death rates for all categories peaked at age 40--49, except that the death rate for prescription drugs was slightly higher among women age 50--59. Prescription drug decedents tended to be slightly older than illicit drug decedents---the median age for prescription drug deaths was 46 years; for illict drugs, 43 years; for both, 43 years; and for neither, 45 years.

We listed the most frequently named substances for each 3-digit drug poisoning cause-of-death categories with at least 25 deaths (\autoref{codlist}). Deaths that are known to be caused by methadone or oxycodone are classified to the `X42' category. It is notable that these drugs are more frequently mentioned among deaths coded to `X44,' suggesting that in many deaths involving these drugs, either the certifier was unsure which drug caused the death, or the certifier filled out the certificate in a way that left the certifier's intent unclear to the SuperMICAR  system.

The top drugs named among suicides are acetaminophen and diphenhydramine (an antihistamine which is a common ingredient in over-the-counter sleep aids) (\autoref{intentlist}). Both drugs are often paired with oxycodone and hydrocodone and diphenhydramine is also often paired with methadone (\autoref{pairs}). The top substances listed among undetermined deaths show commonalities with both the unintentional list and the suicide list. The top six substances on the undetermined list are the same as the top 6 substances on the unintentional list, with methadone being the most frequently named substance on both lists. However, the undetermined list also includes diphenhydramine and acetaminophen, which are not on the unintentional list.

The ICD-10 multiple-cause-of-death codes include both the underlying cause of deaths (shown in \autoref{codlist}), and the ``injury codes'' for all the individual substances named on the certificate. In the ICD-10, injury codes for poisoning range from T36.0 to T65.9. We listed the most commonly named substances for each injury code that was coded on at least 100 deaths (\autoref{tcodelist}). The list illustrates the additional specificity that may be obtained with the SuperMICAR data, compared to the ICD-10 injury codes. Some injury codes are synonymous with a single drug: T40.1 is heroin, T40.3 is methadone, and T40.5 is cocaine. But other injury codes include many different drugs: T40.2 includes oxycodone, hydrocodone, hydromorphone, and other drugs; T43.2 includes citalopram, fluoxetine, and other drugs.

\begin{table}
\center
\begin{minipage}{0.6\textwidth}
\caption{\label{allnames}List of the 25 most frequently mentioned substances among
poisoning deaths among Washington State residents during
2003--2010 ($N = 7,817$).}

\begin{tabular}{rlr} \hline
     &                     & number of deaths \\
rank & substance           & where named$^*$  \\ \hline
  1  & methadone                & 2,149   \\
  2  & alcohol                  & 1,446   \\
  3  & opiate                   & 1,240   \\
  4  & cocaine                  & 1,174   \\
  5  & oxycodone                & 1,047   \\
  6  & methamphetamine          &   681   \\
  7  & morphine                 &   648   \\
  8  & diphenhydramine          &   574   \\
  9  & hydrocodone              &   563   \\
 10  & heroin                   &   539   \\
 11  & citalopram               &   533   \\
 12  & diazepam                 &   468   \\
 13  & alprazolam               &   412   \\
 14  & amitriptyline            &   397   \\
 15  & acetaminophen            &   395   \\
 16  & carbon monoxide          &   394   \\
 17  & hydromorphone            &   269   \\
 18  & fluoxetine               &   243   \\
 19  & trazodone                &   227   \\
 20  & cyclobenzaprine          &   220   \\
 21  & venlafaxine              &   220   \\
 22  & quetiapine               &   199   \\
 23  & fentanyl                 &   198   \\
 24  & sertraline               &   192   \\
 25  & bupropion                &   169   \\
\hline
\end{tabular}

$^*$Many certificates mentioned more than one substance, so the
total number of mentions is greater than the number of deaths. Substances named more than once on a death certificate were counted only once for each death.
\end{minipage}
\end{table}

\begin{detail}

\begin{table}
\center
\begin{minipage}{0.6\textwidth}
\caption{\label{prescripnames}List of the 25 most frequently mentioned substances among
poisoning deaths where at least one prescription drug
was named, among Washington State residents during
2003--2010 ($N = 5,454$). Many certificates mentioned more than one substance, so the
total number of mentions is greater than the number of deaths.}

\begin{tabular}{rlr} \hline
     &                     & number of deaths \\
rank & substance           & where named$^*$  \\ \hline
  1  & methadone               &   2,149  \\
  2  & oxycodone               &   1,047  \\
  3  & alcohol                 &   1,002  \\
  4  & opiate                  &     729  \\
  5  & cocaine                 &     652  \\
  6  & morphine                &     648  \\
  7  & diphenhydramine         &     574  \\
  8  & hydrocodone             &     563  \\
  9  & citalopram              &     533  \\
 10  & diazepam                &     468  \\
 11  & alprazolam              &     412  \\
 12  & amitriptyline           &     397  \\
 13  & acetaminophen           &     321  \\
 14  & methamphetamine         &     292  \\
 15  & hydromorphone           &     269  \\
 16  & fluoxetine              &     243  \\
 17  & trazodone               &     227  \\
 18  & cyclobenzaprine         &     220  \\
 19  & venlafaxine             &     220  \\
 20  & quetiapine              &     199  \\
 21  & fentanyl                &     198  \\
 22  & sertraline              &     192  \\
 23  & bupropion               &     169  \\
 24  & heroin                  &     168  \\
 25  & benzodiazepine          &     163  \\
\hline
\end{tabular}

$^*$Substances named more than once on a death certificate were counted only once for
each death.
\end{minipage}
\end{table}

\begin{table}
\center
\begin{minipage}{0.6\textwidth}
\caption{\label{illicitnames}List of the 25 most frequently mentioned substances among
poisoning deaths where at least one illicit drug
was named, among Washington State residents during
2003--2010 ($N = 2,162$). Many certificates mentioned more than one substance, so the
total number of mentions is greater than the number of deaths.}

\begin{tabular}{rlr} \hline
     &                     & number of deaths \\
rank & substance           & where named$^*$  \\ \hline
  1  & cocaine              & 1,174 \\
  2  & methamphetamine      &   681 \\
  3  & opiate               &   586 \\
  4  & heroin               &   539 \\
  5  & methadone            &   454 \\
  6  & alcohol              &   382 \\
  7  & oxycodone            &   162 \\
  8  & morphine             &   140 \\
  9  & diazepam             &    97 \\
 10  & diphenhydramine      &    90 \\
 11  & citalopram           &    88 \\
 12  & alprazolam           &    73 \\
 13  & amitriptyline        &    69 \\
 14  & hydrocodone          &    66 \\
 15  & hydromorphone        &    46 \\
 16  & benzodiazepine       &    38 \\
 17  & dextromethorphan     &    38 \\
 18  & venlafaxine          &    38 \\
 19  & sertraline           &    35 \\
 20  & trazodone            &    35 \\
 21  & cyclobenzaprine      &    34 \\
 22  & fluoxetine           &    32 \\
 23  & cannabinoid          &    30 \\
 24  & codeine              &    30 \\
 25  & nortriptyline        &    30 \\
\hline
\end{tabular}

$^*$Substances named more than once on a death certificate were counted only once for
each death.
\end{minipage}
\end{table}

\end{detail}

\begin{detail}
Make a table of pairs. For each of the top ten mentioned drugs, list the top ten drugs
named with them. E.g. on certificates that mention methadone, what are the top ten drugs
named (including methadone). This excludes poisoning deaths that were related to medical care.

\begin{lstlisting}[language=sas,caption=Table of pairs]
data pairswide;
   set sm.TcodeWide(where=(('X40' le underly3 le 'X49' or 'X60' le underly3 le 'X69' or
         underly3 = 'X85' or 'Y10' le underly3 le 'Y19') and st_res = '48'));
   array words{14} $ 35 drugword1-drugword14;
   methadone       = 0;
   alcohol         = 0;
   opiate          = 0;
   cocaine         = 0;
   oxycodone       = 0;
   methamphetamine = 0;
   morphine        = 0;
   diphenhydramine = 0;
   hydrocodone     = 0;
   heroin          = 0;
   do i = 1 to 14;
      if put(words{i},$genname.) = "METHADONE"       then methadone       = 1;
      if put(words{i},$genname.) = "ALCOHOL"         then alcohol         = 1;
      if put(words{i},$genname.) = "OPIATE"          then opiate          = 1;
      if put(words{i},$genname.) = "COCAINE"         then cocaine         = 1;
      if put(words{i},$genname.) = "OXYCODONE"       then oxycodone       = 1;
      if put(words{i},$genname.) = "METHAMPHETAMINE" then methamphetamine = 1;
      if put(words{i},$genname.) = "MORPHINE"        then morphine        = 1;
      if put(words{i},$genname.) = "DIPHENHYDRAMINE" then diphenhydramine = 1;
      if put(words{i},$genname.) = "HYDROCODONE"     then hydrocodone     = 1;
      if put(words{i},$genname.) = "HEROIN"          then heroin          = 1;
      end;
run;
data temp2(drop=drugword1-drugword14 Tcode1-Tcode14);
   set pairswide;
   array words{14} $ 35 drugword1-drugword14;
   array Tcodes{14} $ 5 Tcode1-Tcode14;
   do i = 1 to 14;
      if words{i} = '' then return;
      drugword = words{i};
      Tcode    = Tcodes{i};
      drugword_generic = put(drugword,$generic.);
      output;
      end;
run;
proc sort data=temp2 out=PairsLong nodupkey;
   by certno drugword_generic;
run;

%macro freqlist(drugname);
proc freq data=pairslong noprint;
   where &drugname;
   tables drugword/out=&drugname;
   format drugword $genname.;
run;
proc sort data=&drugname;
   by descending count;
run;
options ls=64;
proc print data=&drugname(obs=15);
run;
options ls=145;
%mend;

%freqlist(methadone);
%freqlist(alcohol        );
%freqlist(opiate         );
%freqlist(cocaine        );
%freqlist(oxycodone      );
%freqlist(methamphetamine);
%freqlist(morphine       );
%freqlist(diphenhydramine);
%freqlist(hydrocodone    );
%freqlist(heroin         );
\end{lstlisting}

Results:

\bfs
\bvm
                     The SAS System                       35
                                11:02 Thursday, July 5, 2012

       Obs    drugword           COUNT    PERCENT

         1    METHADONE           2149    27.4668
         2    DRUG                1142    14.5961
         3    MEDICATION           462     5.9049
         4    COCAINE              320     4.0900
         5    ALCOHOL              278     3.5532
         6    OXYCODONE            239     3.0547
         7    DIAZEPAM             204     2.6074
         8    PRESCRIPTION         198     2.5307
         9    ALPRAZOLAM           184     2.3517
        10    CITALOPRAM           181     2.3134
        11    OPIATE               162     2.0706
        12    DIPHENHYDRAMINE      159     2.0322
        13    HYDROCODONE          136     1.7382
        14    METHAMPHETAMINE      130     1.6616
        15    AMITRIPTYLINE        104     1.3292

                     The SAS System                       36
                                11:02 Thursday, July 5, 2012

       Obs    drugword           COUNT    PERCENT

         1    ALCOHOL             1446    25.9932
         2    DRUG                 753    13.5359
         3    OPIATE               299     5.3748
         4    METHADONE            278     4.9973
         5    OXYCODONE            233     4.1884
         6    COCAINE              217     3.9008
         7    MEDICATION           198     3.5592
         8    HEROIN               169     3.0379
         9    PRESCRIPTION         118     2.1212
        10    DIPHENHYDRAMINE      114     2.0493
        11    HYDROCODONE          110     1.9774
        12    CITALOPRAM           106     1.9054
        13    ALCOHOLISM            94     1.6897
        14    MORPHINE              92     1.6538
        15    DIAZEPAM              88     1.5819

                     The SAS System                       37
                                11:02 Thursday, July 5, 2012

       Obs    drugword           COUNT    PERCENT

         1    OPIATE              1240    25.0860
         2    DRUG                 739    14.9504
         3    COCAINE              333     6.7368
         4    ALCOHOL              299     6.0490
         5    HEROIN               265     5.3611
         6    MORPHINE             206     4.1675
         7    METHADONE            162     3.2774
         8    MEDICATION           104     2.1040
         9    OXYCODONE            100     2.0231
        10    PRESCRIPTION          96     1.9421
        11    METHAMPHETAMINE       90     1.8208
        12    CITALOPRAM            84     1.6994
        13    HYDROMORPHONE         70     1.4161
        14    DIAZEPAM              68     1.3757
        15    DIPHENHYDRAMINE       61     1.2341

                     The SAS System                       38
                                11:02 Thursday, July 5, 2012

       Obs    drugword           COUNT    PERCENT

         1    COCAINE             1174    27.4941
         2    DRUG                 786    18.4075
         3    OPIATE               333     7.7986
         4    METHADONE            320     7.4941
         5    ALCOHOL              217     5.0820
         6    HEROIN               129     3.0211
         7    OXYCODONE            114     2.6698
         8    METHAMPHETAMINE       92     2.1546
         9    MORPHINE              67     1.5691
        10    DIPHENHYDRAMINE       66     1.5457
        11    DIAZEPAM              65     1.5222
        12    CITALOPRAM            60     1.4052
        13    MEDICATION            49     1.1475
        14    ALPRAZOLAM            44     1.0304
        15    AMITRIPTYLINE         43     1.0070

                     The SAS System                       39
                                11:02 Thursday, July 5, 2012

       Obs    drugword           COUNT    PERCENT

         1    OXYCODONE           1047    21.8261
         2    DRUG                 567    11.8199
         3    MEDICATION           297     6.1914
         4    METHADONE            239     4.9823
         5    ALCOHOL              233     4.8572
         6    DIAZEPAM             148     3.0853
         7    PRESCRIPTION         126     2.6266
         8    DIPHENHYDRAMINE      120     2.5016
         9    CITALOPRAM           115     2.3973
        10    ALPRAZOLAM           114     2.3765
        11    COCAINE              114     2.3765
        12    HYDROCODONE          102     2.1263
        13    OPIATE               100     2.0846
        14    ACETAMINOPHEN         91     1.8970
        15    MORPHINE              75     1.5635

                     The SAS System                       40
                                11:02 Thursday, July 5, 2012

       Obs    drugword           COUNT    PERCENT

         1    METHAMPHETAMINE     681     32.2902
         2    DRUG                422     20.0095
         3    METHADONE           130      6.1641
         4    COCAINE              92      4.3623
         5    OPIATE               90      4.2674
         6    HEROIN               64      3.0346
         7    MORPHINE             45      2.1337
         8    ALCOHOL              42      1.9915
         9    MEDICATION           40      1.8966
        10    OXYCODONE            39      1.8492
        11    DIAZEPAM             30      1.4225
        12    HYDROCODONE          22      1.0431
        13    AMITRIPTYLINE        19      0.9009
        14    CITALOPRAM           19      0.9009
        15    DIPHENHYDRAMINE      18      0.8535

                     The SAS System                       41
                                11:02 Thursday, July 5, 2012

       Obs    drugword           COUNT    PERCENT

         1    MORPHINE            648     22.0784
         2    DRUG                366     12.4702
         3    OPIATE              206      7.0187
         4    MEDICATION          169      5.7581
         5    ALCOHOL              92      3.1346
         6    METHADONE            82      2.7939
         7    OXYCODONE            75      2.5554
         8    HYDROMORPHONE        72      2.4532
         9    COCAINE              67      2.2828
        10    PRESCRIPTION         67      2.2828
        11    HYDROCODONE          65      2.2147
        12    DIAZEPAM             56      1.9080
        13    CODEINE              55      1.8739
        14    DIPHENHYDRAMINE      51      1.7376
        15    CITALOPRAM           49      1.6695

                     The SAS System                       42
                                11:02 Thursday, July 5, 2012

       Obs    drugword           COUNT    PERCENT

         1    DIPHENHYDRAMINE     574     18.9564
         2    DRUG                329     10.8653
         3    MEDICATION          191      6.3078
         4    METHADONE           159      5.2510
         5    OXYCODONE           120      3.9630
         6    ALCOHOL             114      3.7649
         7    ACETAMINOPHEN       102      3.3686
         8    HYDROCODONE          70      2.3118
         9    COCAINE              66      2.1797
        10    CITALOPRAM           65      2.1466
        11    PRESCRIPTION         62      2.0476
        12    OPIATE               61      2.0145
        13    DIAZEPAM             55      1.8164
        14    MORPHINE             51      1.6843
        15    ALPRAZOLAM           50      1.6513

                     The SAS System                       43
                                11:02 Thursday, July 5, 2012

       Obs    drugword           COUNT    PERCENT

         1    HYDROCODONE         563     19.2544
         2    DRUG                312     10.6703
         3    MEDICATION          210      7.1819
         4    METHADONE           136      4.6512
         5    ACETAMINOPHEN       114      3.8988
         6    ALCOHOL             110      3.7620
         7    OXYCODONE           102      3.4884
         8    HYDROMORPHONE        90      3.0780
         9    PRESCRIPTION         71      2.4282
        10    DIPHENHYDRAMINE      70      2.3940
        11    CITALOPRAM           65      2.2230
        12    MORPHINE             65      2.2230
        13    DIAZEPAM             64      2.1888
        14    OPIATE               52      1.7784
        15    ALPRAZOLAM           51      1.7442

                     The SAS System                       44
                                11:02 Thursday, July 5, 2012

       Obs    drugword           COUNT    PERCENT

         1    HEROIN              539     29.0880
         2    DRUG                331     17.8629
         3    OPIATE              265     14.3011
         4    ALCOHOL             169      9.1203
         5    COCAINE             129      6.9617
         6    METHAMPHETAMINE      64      3.4539
         7    MORPHINE             41      2.2126
         8    METHADONE            38      2.0507
         9    NARCOTISM            25      1.3492
        10    ALPRAZOLAM           12      0.6476
        11    CITALOPRAM           12      0.6476
        12    CODEINE              12      0.6476
        13    DIPHENHYDRAMINE      12      0.6476
        14    OXYCODONE            12      0.6476
        15    PRESCRIPTION         12      0.6476
\end{verbatim}
\efs

\end{detail}


\begin{screen}
   \onecolumn
   \begin{table}
   \small
\end{screen}
\begin{print}
   \begin{sidewaystable}
   \footnotesize
\end{print}
\caption{\label{pairs} Frequently mentioned drug pairs. For each of the ten most
frequently mentioned drugs (including alcohol), the table shows the ten other drugs most frequently
mentioned with it. The data are from poisoning deaths
among Washington State residents during 2003--2010 ($N = 7,817$).}

\begin{tabular}{lrrrrrrrrrrrrrrrrrr} \hline
                &       &        &         &        &        &        & meth-   &        & diphen- &        &        &        &       & al-   & hydro- & acet-  &       & ami-    \\
                &       & meth-  &         &        & co-    & oxy-   & amphet- & mor-   & hydra-  & hydro- &        & cital- & diaz- & praz- & mor-   & amino- & co-   & trip-   \\
substance       & N     & adone  & alcohol & opiate & caine  & codone & amine   & phine  & mine    & codone & heroin & opram  & epam  & olam  & phone  & phen   & deine & tyline  \\ \hline

methadone       & 2,149 &     .  & 278     & 162    & 320    & 239    & 130     & ---    &  159    & 136    & ---    &  181   & 204   &  184  &  ---   &   ---  &  ---  &  ---    \\
alcohol         & 1,446 &   278  &   .     & 299    & 217    & 233    & ---     &  92    &  114    & 110    & 169    &  106   &  88   &  ---  &  ---   &   ---  &  ---  &  ---    \\
opiate          & 1,240 &   162  & 299     &   .    & 333    & 100    &  90     & 206    &  ---    & ---    & 265    &   84   &  68   &  ---  &   70   &   ---  &  ---  &  ---    \\
cocaine         & 1,174 &   320  & 217     & 333    &   .    & 114    &  92     &  67    &   66    & ---    & 129    &   60   &  65   &  ---  &  ---   &   ---  &  ---  &  ---    \\
oxycodone       & 1,047 &   239  & 233     & 100    & 114    &   .    & ---     & ---    &  120    & 102    & ---    &  115   & 148   &  114  &  ---   &    91  &  ---  &  ---    \\
methamphetamine &   681 &   130  &  42     &  90    &  92    &  39    &   .     &  45    &  ---    &  22    &  64    &  ---   &  30   &  ---  &  ---   &   ---  &  ---  &   19    \\
morphine        &   648 &    82  &  92     & 206    &  67    &  75    & ---     &   .    &   51    &  65    & ---    &  ---   &  56   &  ---  &  72    &   ---  &   55  &  ---    \\
diphenhydramine &   574 &   159  & 114     &  61    &  66    & 120    & ---     &  51    &    .    &  70    & ---    &   65   &  55   &  ---  &  ---   &   102  &  ---  &  ---    \\
hydrocodone     &   563 &   136  & 110     &  52    & ---    & 102    & ---     &  65    &   70    &   .    & ---    &   65   &  64   &  ---  &  90    &   114  &  ---  &  ---    \\
heroin          &   539 &    38  & 169     & 265    & 129    & ---    &  64     &  41    &   12    & ---    &   .    &   12   & ---   &   12  &  ---   &   ---  &   12  &  ---    \\
\hline
\end{tabular}

$^*$Drugs named more than once on a death certificate were counted only once for
each death.
\begin{screen}
   \end{table}
   \twocolumn
\end{screen}
\begin{print}
   \end{sidewaystable}
\end{print}


\begin{detail}

\begin{screen}
   \onecolumn
   \begin{table}
   \small
\end{screen}
\begin{print}
   \begin{sidewaystable}
   \footnotesize
\end{print}
\caption{\label{pairs} Frequently mentioned drug pairs. For each of the ten most
frequently mentioned drugs (including alcohol), the table shows the five other drugs most 
frequently mentioned with it. The data are from poisoning deaths among Washington State residents 
during 2003--2010 ($N = 7,817$).}

\begin{tabular}{lrrrrrrrrrrrrrrrrrr} \hline
                &       & metha- &         &        &        & oxy-   & metham-   & morph- & diphenhy- & hydro- &        & cital- & diaz- & alpraz- & hydro-   & aceta-   \\
substance       & N     & done   & alcohol & opiate & cocaine& codone & phetamine & ine    & dramine   & codone & heroin & opram  & epam  & olam    & morphone & minophen \\ \hline

methadone       & 2,149 &     .  & 278     & ---    & 320    & 239    & ---       & ---    &  ---      & ---    & ---    &  ---   & 204   &  184    &  ---     &   ---    \\
alcohol         & 1,446 &   278  &   .     & 299    & 217    & 233    & ---       & ---    &  ---      & ---    & 169    &  ---   & ---   &  ---    &  ---     &   ---    \\
opiate          & 1,240 &   162  & 299     &   .    & 333    & ---    & ---       & 206    &  ---      & ---    & 265    &  ---   & ---   &  ---    &  ---     &   ---    \\
cocaine         & 1,174 &   320  & 217     & 333    &   .    & 114    & ---       & ---    &  ---      & ---    & 129    &  ---   & ---   &  ---    &  ---     &   ---    \\
oxycodone       & 1,047 &   239  & 233     & ---    & ---    &   .    & ---       & ---    &  120      & ---    & ---    &  115   & 148   &  ---    &  ---     &   ---    \\
methamphetamine &   681 &   130  & ---     &  90    &  92    & ---    &   .       &  45    &  ---      & ---    &  64    &  ---   & ---   &  ---    &  ---     &   ---    \\
morphine        &   648 &    82  &  92     & 206    & ---    &  75    & ---       &   .    &  ---      & ---    & ---    &  ---   & ---   &  ---    &  72      &   ---    \\
diphenhydramine &   574 &   159  & 114     & ---    & ---    & 120    & ---       & ---    &    .      &  70    & ---    &  ---   & ---   &  ---    &  ---     &   102    \\
hydrocodone     &   563 &   136  & 110     & ---    & ---    & 102    & ---       & ---    &  ---      &   .    & ---    &  ---   & ---   &  ---    &  90      &   114    \\
heroin          &   539 &    38  & 169     & 265    & 129    & ---    &  64       & ---    &  ---      & ---    &   .    &  ---   & ---   &  ---    &  ---     &   ---    \\
\hline
\end{tabular}

$^*$Drugs named more than once on a death certificate were counted only once for
each death.
\begin{screen}
   \end{table}
   \twocolumn
\end{screen}
\begin{print}
   \end{sidewaystable}
\end{print}


I will tabulate the data with SAS, compute rates, and import the rates and counts into R
for graphing.

First, I need to decide whether to treat ``opiate'' as a named drug or not. If certificates with
that word on them generally also have a specific opiate named, then I will not use opiate as a named
drug; otherwise I will. Here's how I will look at this: I will extract the death certs with the
drugword ``opiate'' from the dataset {\tt TcodeLong}, and deduplicate this to make sure I include
each death cert at most once. Then I will merge this file with the dataset {\tt TcodeWide} to get
all the information for each of those death certs. In {\tt TcodeLong}, I will count the number of
certificates that have a Tcode for an opiate (T40.0, T40.1, T40.2, or T40.3) where the matching
drugword is not ``opiate.''

And I find that almost half (543 of 1,240) of the certificates with the word ``opiate'' on them do
not have a specific opiate named. So I will create a file that deletes the records with
the word ``opiate'' when a specific opiate is mentioned on the record. The file {\tt
opiate2} below has a field named {\tt otheropiate} where a value of ``Y'' means the death
cert has a specific opiate mentioned in addition to the term ``opiate.''


\begin{lstlisting}[language=sas,caption=Is opiate a named drug?]
libname sm  'c:\data\poisoning\SuperMICAR';
%include "c:\user\poisoning\SuperMICAR\generic.sas";
data opiate(keep=certno opiate);
   length opiate $ 1;
   set sm.TcodeLong(where=(('X40' le underly3 le 'Y19') and st_res = '48'));
   if put(drugword,$generic.) = 'c-OPIATE' then do;
      opiate = 'Y';
      output;
      end;
run;
proc sort data=opiate nodupkey;
   by certno;
run;
proc sort data=sm.TcodeWide;
   by certno;
run;
data opiate2;
   merge opiate(in=inopiate) sm.TcodeWide;
   by certno;
   if inopiate;
   array tcode{14} Tcode1-Tcode14;
   array drugword{14} drugword1-drugword14;
   otheropiate = 'N';
   do i = 1 to 14;
      if Tcode{i} in ('T40.0','T40.1','T40.2','T40.3','T40.4') and
         put(drugword{i},$generic.) ne 'c-OPIATE' then otheropiate = 'Y';
      end;
run;
proc freq data=opiate2;
   tables otheropiate;
run;
/*
results
       The SAS System                                   09:40 Friday, June 22, 2012  81

                          The FREQ Procedure

                                           Cumulative    Cumulative
   otheropiate    Frequency     Percent     Frequency      Percent
   ----------------------------------------------------------------
   N                   543       43.79           543        43.79
   Y                   697       56.21          1240       100.00
\end{lstlisting}

Create a drugname file from TcodeLong that excludes records with the word ``opiate'' when
the certificate containing the word also has a specific opiate named. This program uses
the datafile {\tt opiate2} created above.

The new file {\tt TcodeLong2} contains records for poisoning deaths (underlying cause 
X40--Y19) among Washington residents, and excludes the drugword ``opiate'' when the same death 
record has a specific opiate named, and excludes the duplicates of drug generics named more than 
once on a record.

\begin{lstlisting}[language=sas,caption=create file that excludes non-specific opiate]
proc sort data=opiate2;
   by certno;
run;
proc sort data=sm.TcodeLong;
   by certno;
run;
data temp2;
   merge sm.TcodeLong(where=(('X40' le underly3 le 'Y19') and st_res = '48'))  
         opiate2(keep=certno otheropiate);
   by certno;
   if put(drugword,$generic.) = 'c-OPIATE' and otheropiate = 'Y' then delete;
   drugword_genname = put(drugword,$genname.);
run;
proc sort data=temp2 out=temp3 nodupkey;
   by certno drugword_genname; 
run;
/*
Compute rate per year of the top 20 drugs
*/
data sm.TcodeLong2;
   length top15 $ 1;
   set temp3;
   drugword_generic = put(drugword,$generic.);
   if drugword_genname in (
      'METHADONE      ',
      'ALCOHOL        ',
      'COCAINE        ',
      'OXYCODONE      ',
      'METHAMPHETAMINE',
      'MORPHINE       ',
      'DIPHENHYDRAMINE',
      'HYDROCODONE    ',
      'OPIATE         ',
      'HEROIN         ',
      'CITALOPRAM     ',
      'DIAZEPAM       ',
      'ALPRAZOLAM     ',
      'AMITRIPTYLINE  ',
      'ACETAMINOPHEN  ')  then top15 = 'Y';
   else top15 = 'N';
   drugword_cat = put(drugword,$licitcat.);
   select;
      when( 0 le age le 9 ) agegrp = ' 0-9 ';
      when(10 le age le 19) agegrp = '10-19';
      when(20 le age le 29) agegrp = '20-29';
      when(30 le age le 39) agegrp = '30-39';
      when(40 le age le 49) agegrp = '40-49';
      when(50 le age le 59) agegrp = '50-59';
      when(60 le age le 69) agegrp = '60-69';
      when(70 le age le 79) agegrp = '70-79';
      when(80 le age      ) agegrp = '80+  ';
   end;
run;
/*
check numbers
*/
proc freq data=sm.TcodeLong2 noprint;
   where top15 = 'Y';
   tables drugword/out=wordlist;
   format drugword $genname.;
run;
proc sort data=wordlist;
   by descending count;
run;
proc print data=wordlist uniform;
run;
\end{lstlisting}

After removing the redundant opiate entries, the 15 most commonly named drugs are

\bfs
\bvm
  1  & methadone           & 2,149  \\
  2  & alcohol             & 1,446  \\
  3  & cocaine             & 1,174  \\
  4  & oxycodone           & 1,047  \\
  5  & methamphetamine     &   681  \\
  6  & morphine            &   648  \\
  7  & diphenhydramine     &   574  \\
  8  & hydrocodone         &   563  \\
  9  & opiate              &   543  \\
 10  & heroin              &   539  \\
 11  & citalopram          &   533  \\
 12  & diazepam            &   468  \\
 13  & alprazolam          &   412  \\
 14  & amitriptyline       &   397  \\
 15  & acetaminophen       &   395  \\
\end{verbatim}
\efs

For analysis, I need rates. Here, I compute rates by year; by year and sex; by sex; by age and sex; 
and by age for each of the top 15 named drugs, and for all drug poisonings.

\begin{lstlisting}[language=sas,caption=Compute rates by year age and sex]
/*
tabulate the population data. Here I output a line for each drugname to ensure that
every age by sex by year group will have a line even if there are no deaths, so
I can graph those points
*/
data popfile(drop=agegrp rename=(agegroup=agegrp));
   length drugname $ 26;
   set pop.pop2003 pop.pop2004 pop.pop2005 pop.pop2006 pop.pop2007 pop.pop2008 pop.pop2009
       pop.pop2010;
   where county = 'ST';
   select;
      when(agegrp in (' 0-4 ',' 5-9 ')) agegroup = ' 0-9 ';
      when(agegrp in ('10-14','15-19')) agegroup = '10-19';
      when(agegrp in ('20-24','25-29')) agegroup = '20-29';
      when(agegrp in ('30-34','35-39')) agegroup = '30-39';
      when(agegrp in ('40-44','45-49')) agegroup = '40-49';
      when(agegrp in ('50-54','55-59')) agegroup = '50-59';
      when(agegrp in ('60-64','65-69')) agegroup = '60-69';
      when(agegrp in ('70-74','75-79')) agegroup = '70-79';
      when(agegrp in ('80-84','85+  ')) agegroup = '80+  ';
      when(agegrp in ('15-17'))         delete;
   end;
   drugname = 'METHADONE      ';
   output;
   drugname = 'ALCOHOL        ';
   output;
   drugname = 'COCAINE        ';
   output;
   drugname = 'OXYCODONE      ';
   output;
   drugname = 'METHAMPHETAMINE';
   output;
   drugname = 'MORPHINE       ';
   output;
   drugname = 'DIPHENHYDRAMINE';
   output;
   drugname = 'HYDROCODONE    ';
   output;
   drugname = 'OPIATE         ';
   output;
   drugname = 'HEROIN         ';
   output;
   drugname = 'CITALOPRAM     ';
   output;
   drugname = 'DIAZEPAM       ';
   output;
   drugname = 'ALPRAZOLAM     ';
   output;
   drugname = 'AMITRIPTYLINE  ';
   output;
   drugname = 'ACETAMINOPHEN  ';
   output;
run;
proc summary data=popfile;
   class year sex agegrp drugname;
   var pop;
   output out=popsumm sum=pop;
run;
/*
rates by year, age group, sex, and drugname
*/
proc summary data=sm.TcodeLong2;
   where top15 = 'Y';
   class year sex agegrp drugword_genname;
   output out=namesumm1(rename=(_freq_=deaths drugword_genname=drugname));
run;
data namesumm2;
   set namesumm1;
   if sex = '' then sex = 'T';
run;
proc sort data=namesumm2;
   by year sex agegrp drugname;
run;
proc sort data=popsumm;
   by year sex agegrp drugname;
run;

data namerate(drop=_type_ _freq_);
   merge namesumm2(where=(drugname ne '')) popsumm(where=(drugname ne '' and sex ne ''));
   by year sex agegrp drugname;
   if deaths = . then deaths = 0;
   rate = (deaths/pop)*100000;
   if year = ''   then year = 'Tot ';
   if agegrp = '' then agegrp = 'Total';
run;
/*
change the case of some names to make them easier to use in R
*/
data namerate2(rename=(tyear=year tsex=sex));
   set namerate(rename=(sex=tsex year=tyear));
run;
proc export data=namerate2 
   outfile = 'c:\user\poisoning\supermicar\analysis\namerate.dat'
   dbms=csv
   replace
   ;
run;
\end{lstlisting}

\bfs
<<>>=
namerate.dat <- read.csv("..\\namerate.dat",header=T)

PlotByYear <- function(drug,color=1){
   with(namerate.dat[namerate.dat$agegrp=='Total' & namerate.dat$sex=='T' & 
      namerate.dat$year!='Tot' & namerate.dat$drugname==drug,], plot(as.numeric(year),rate,
      xlab='Year',ylab='Rate per 100,000',ylim=c(0,5.5),xlim=c(1,9),axes=F,col=color,pch=20))
   axis(1,at=c(1:8),labels=c(2003:2010))
   axis(2,las=1)
   box()
   with(namerate.dat[namerate.dat$agegrp=='Total' & namerate.dat$sex=='T' & 
      namerate.dat$year!='Tot' & namerate.dat$drugname==drug,], 
      lines(as.numeric(year),loess(rate~as.numeric(year),span=1)$fitted,col=color))
}
AddToPlotByYear <- function(drug,color=2){
   with(namerate.dat[namerate.dat$agegrp=='Total' & namerate.dat$sex=='T' & 
      namerate.dat$year!='Tot' & namerate.dat$drugname==drug,], 
      points(as.numeric(year),rate,col=color,pch=20))
   with(namerate.dat[namerate.dat$agegrp=='Total' & namerate.dat$sex=='T' & 
      namerate.dat$year!='Tot' & namerate.dat$drugname==drug,], 
      lines(as.numeric(year),loess(rate~as.numeric(year),span=1)$fitted,col=color))
}

@
\efs

A plot by year of all of the 15 top drugs shows that most of them have been between about 0.5 and 
1.5 mentions per 100,000 population for the entire period 2003--2010 (\autoref{plotbyyear1}). The 
more interesting patterns are in the top 4 or 5, and I plot them separately 
(\autoref{plotbyyear2}). 

\begin{figure}
<<plotbyyear1,fig=T,echo=F,height=10,width=7.5>>=
PlotByYear('METHADONE')
AddToPlotByYear('ALCOHOL')
AddToPlotByYear('COCAINE')
AddToPlotByYear('OXYCODONE')
AddToPlotByYear('METHAMPHETAMINE')

AddToPlotByYear('MORPHINE',4)
AddToPlotByYear('DIPHENHYDRAMINE',3)
AddToPlotByYear('HYDROCODONE',5)
AddToPlotByYear('OPIATE',6)
AddToPlotByYear('HEROIN',8)
AddToPlotByYear('CITALOPRAM')
AddToPlotByYear('DIAZEPAM')
AddToPlotByYear('ALPRAZOLAM')
AddToPlotByYear('AMITRIPTYLINE')
AddToPlotByYear('ACETAMINOPHEN')
@ 
\caption{\label{plotbyyear1}Crude rates of the deaths on which the top 15 drugs are 
named, per 100,000 population.}
\end{figure}


\begin{figure}
<<plotbyyear2,fig=T,echo=F,height=10,width=7.5>>=
PlotByYear('METHADONE',color=1)
AddToPlotByYear('ALCOHOL',color=2)
AddToPlotByYear('COCAINE',color=3)
AddToPlotByYear('OXYCODONE',color=4)
AddToPlotByYear('METHAMPHETAMINE',color=6)
text(8.6,3.4,'Methadone',cex=0.8)
text(8.6,2.7,'Alcohol',cex=0.8)
text(8.6,1.1,'Cocaine',cex=0.8)
text(8.6,2.2,'Oxycodone',cex=0.8)
text(8.6,1.4,'Methamphetamine',cex=0.8)
@ 
\caption{\label{plotbyyear2}Crude rates of the deaths on which the top 5 drugs are 
named, per 100,000 population.}
\end{figure}
\end{detail}

\begin{detail}
Trends by age and sex of the 15 most commonly named drugs.

\bfs
<<>>=
PlotByAgeSex <- function(drug,color=1,sex='T',ymax=13){
   with(namerate.dat[namerate.dat$agegrp!='Total' & namerate.dat$sex==sex & 
      namerate.dat$year=='Tot' & namerate.dat$drugname==drug,], plot(1:9,rate,
      xlab='Age group',ylab='Rate per 100,000',ylim=c(0,ymax),xlim=c(1,10),axes=F,col=color,pch=20,
      type='l',lwd=2))
   axis(1,at=c(1:9),labels=c('0-9','10-19','20-29','30-39','40-49','50-59','60-69','70-79','80+'))
   axis(2,las=1)
#   box()
#   with(namerate.dat[namerate.dat$agegrp!='Total' & namerate.dat$sex==sex & 
#      namerate.dat$year=='Tot' & namerate.dat$drugname==drug,], 
#      lines(1:9,rate,col=color))
}
PlotByAgeSex2 <- function(drug,color=1,sex='T',ymax=13){
#
# y-axis is not plotted here
#
   with(namerate.dat[namerate.dat$agegrp!='Total' & namerate.dat$sex==sex & 
      namerate.dat$year=='Tot' & namerate.dat$drugname==drug,], plot(1:9,rate,
      xlab='Age group',ylab='',ylim=c(0,ymax),xlim=c(1,10),axes=F,col=color,pch=20,type='l',
      lwd=2))
   axis(1,at=c(1:9),labels=c('0-9','10-19','20-29','30-39','40-49','50-59','60-69','70-79','80+'))
#   box()
#   with(namerate.dat[namerate.dat$agegrp!='Total' & namerate.dat$sex==sex & 
#      namerate.dat$year=='Tot' & namerate.dat$drugname==drug,], 
#      lines(1:9,rate,col=color))
}
AddToPlotByAgeSex <- function(drug,color=1,sex='T'){
#   with(namerate.dat[namerate.dat$agegrp!='Total' & namerate.dat$sex==sex & 
#      namerate.dat$year=='Tot' & namerate.dat$drugname==drug,], points(1:9,rate,col=color,pch=20))
   with(namerate.dat[namerate.dat$agegrp!='Total' & namerate.dat$sex==sex & 
      namerate.dat$year=='Tot' & namerate.dat$drugname==drug,], 
      lines(1:9,rate,col=color,lwd=2))
}


@
\efs

\begin{figure}
<<plotbyage1,fig=T,echo=F,height=10,width=7.5>>=
PlotByAgeSex('METHADONE',sex='T',1,ymax=9.0)
AddToPlotByAgeSex('ALCOHOL',sex='T',2)
AddToPlotByAgeSex('COCAINE',sex='T',3)
AddToPlotByAgeSex('OXYCODONE',sex='T',4)
AddToPlotByAgeSex('METHAMPHETAMINE',sex='T',6)
title('Both Sexes')

AddToPlotByAgeSex('MORPHINE',sex='T',4)
AddToPlotByAgeSex('DIPHENHYDRAMINE',sex='T',3)
AddToPlotByAgeSex('HYDROCODONE',sex='T',5)
AddToPlotByAgeSex('OPIATE',sex='T',6)
AddToPlotByAgeSex('HEROIN',sex='T',8)
AddToPlotByAgeSex('CITALOPRAM',sex='T')
AddToPlotByAgeSex('DIAZEPAM',sex='T')
AddToPlotByAgeSex('ALPRAZOLAM',sex='T')
AddToPlotByAgeSex('AMITRIPTYLINE',sex='T')
AddToPlotByAgeSex('ACETAMINOPHEN',sex='T')
@ 
\caption{\label{plotbyage1}Crude rates of the deaths on which the top 15 drugs are 
named, per 100,000 population.}
\end{figure}


\begin{figure}
<<plotbyage2,fig=T,echo=F,height=10,width=7.5>>=
PlotByAgeSex('METHADONE',sex='M',1,ymax=10.5)
AddToPlotByAgeSex('ALCOHOL',sex='M',2)
AddToPlotByAgeSex('COCAINE',sex='M',3)
AddToPlotByAgeSex('OXYCODONE',sex='M',4)
AddToPlotByAgeSex('METHAMPHETAMINE',sex='M',6)
title('Men')

AddToPlotByAgeSex('MORPHINE',sex='M',4)
AddToPlotByAgeSex('DIPHENHYDRAMINE',sex='M',3)
AddToPlotByAgeSex('HYDROCODONE',sex='M',5)
AddToPlotByAgeSex('OPIATE',sex='M',6)
AddToPlotByAgeSex('HEROIN',sex='M',8)
AddToPlotByAgeSex('CITALOPRAM',sex='M')
AddToPlotByAgeSex('DIAZEPAM',sex='M')
AddToPlotByAgeSex('ALPRAZOLAM',sex='M')
AddToPlotByAgeSex('AMITRIPTYLINE',sex='M')
AddToPlotByAgeSex('ACETAMINOPHEN',sex='M')
@ 
\caption{\label{plotbyage2}Crude rates of the deaths on which the top 15 drugs are 
named, per 100,000 population.}
\end{figure}


\begin{figure}
<<plotbyage3,fig=T,echo=F,height=10,width=7.5>>=
PlotByAgeSex('METHADONE',sex='F',1,ymax=8.0)
AddToPlotByAgeSex('ALCOHOL',sex='F',2)
AddToPlotByAgeSex('COCAINE',sex='F',3)
AddToPlotByAgeSex('OXYCODONE',sex='F',4)
AddToPlotByAgeSex('METHAMPHETAMINE',sex='F',6)
title('Women')

AddToPlotByAgeSex('MORPHINE',sex='F',4)
AddToPlotByAgeSex('DIPHENHYDRAMINE',sex='F',3)
AddToPlotByAgeSex('HYDROCODONE',sex='F',5)
AddToPlotByAgeSex('OPIATE',sex='F',6)
AddToPlotByAgeSex('HEROIN',sex='F',8)
AddToPlotByAgeSex('CITALOPRAM',sex='F')
AddToPlotByAgeSex('DIAZEPAM',sex='F')
AddToPlotByAgeSex('ALPRAZOLAM',sex='F')
AddToPlotByAgeSex('AMITRIPTYLINE',sex='F')
AddToPlotByAgeSex('ACETAMINOPHEN',sex='F')
@ 
\caption{\label{plotbyage3}Crude rates of the deaths on which the top 15 drugs are 
named, per 100,000 population.}
\end{figure}

\end{detail}

\clearpage

\begin{figure}
<<plotbyage4,fig=T,echo=F,height=5,width=7.5>>=
savepar <- par(mfrow=c(1,3),oma=c(5,5,4,2),mar=c(0,0,0,0))
PlotByAgeSex('METHADONE',sex='T',1,ymax=11.5)
AddToPlotByAgeSex('ALCOHOL',sex='T',2)
AddToPlotByAgeSex('COCAINE',sex='T',3)
AddToPlotByAgeSex('OXYCODONE',sex='T',4)
AddToPlotByAgeSex('METHAMPHETAMINE',sex='T',6)
mtext('Rate per 100,000', side=2,line=3.5)
mtext('Age group',side=1,line=3)
title('Both sexes',line=-1)

PlotByAgeSex2('METHADONE',sex='M',1,ymax=11.5)
AddToPlotByAgeSex('ALCOHOL',sex='M',2)
AddToPlotByAgeSex('COCAINE',sex='M',3)
AddToPlotByAgeSex('OXYCODONE',sex='M',4)
AddToPlotByAgeSex('METHAMPHETAMINE',sex='M',6)
mtext('Age group',side=1,line=3)
title('Men',line=-1)
PlotByAgeSex2('METHADONE',sex='F',1,ymax=11.5)
AddToPlotByAgeSex('ALCOHOL',sex='F',2)
AddToPlotByAgeSex('COCAINE',sex='F',3)
AddToPlotByAgeSex('OXYCODONE',sex='F',4)
AddToPlotByAgeSex('METHAMPHETAMINE',sex='F',6)
title('Women',line=-1)
mtext('Age group',side=1,line=3)
legend(4.0,11,legend=c('Methadone','Alcohol','Cocaine','Oxycodone','Methamphetamine'),
   col=c(1,2,3,4,6),lty=c(1,1,1,1,1),lwd=c(2,2,2,2,2))

par(savepar)
@ 
\caption{\label{plotbyage4}Age-specific rates of the deaths in which the top 5 drugs are 
named, per 100,000 population.}
\end{figure}

\begin{detail}

I will compute and graph rates of deaths associated with illicit and prescription 
drugs, or either or both, by age and sex, and by year and sex.

The data show a notable distinction by intent: almost all suicides are associated with 
prescription meds.

\begin{lstlisting}[language=sas,caption=Illicit vs prescription]
libname sm  'c:\data\poisoning\SuperMICAR';
%include "c:\user\poisoning\SuperMICAR\generic.sas";
proc format;
   value $Flag
      '0' = 'Neither'
      '1' = 'Both'
      '2' = 'Prescription'
      '3' = 'Illicit'
      'T' = 'Total'
      ;
run;
data prelicit1;
   set sm.TcodeWide(where=(('X40' le underly3 le 'Y19') and st_res = '48'));
   if illicit_flag = 'N' and prescrip_flag = 'N' then Flag = '0';
   if illicit_flag = 'Y' and prescrip_flag = 'Y' then Flag = '1';
   if illicit_flag = 'N' and prescrip_flag = 'Y' then Flag = '2';
   if illicit_flag = 'Y' and prescrip_flag = 'N' then Flag = '3';
   select;
      when( 0 le age le 9 ) agegrp = ' 0-9 ';
      when(10 le age le 19) agegrp = '10-19';
      when(20 le age le 29) agegrp = '20-29';
      when(30 le age le 39) agegrp = '30-39';
      when(40 le age le 49) agegrp = '40-49';
      when(50 le age le 59) agegrp = '50-59';
      when(60 le age le 69) agegrp = '60-69';
      when(70 le age le 79) agegrp = '70-79';
      when(80 le age      ) agegrp = '80+  ';
   end;
   format Flag $Flag.;
run;
data popfile(drop=agegrp rename=(agegroup=agegrp));
   set pop.pop2003 pop.pop2004 pop.pop2005 pop.pop2006 pop.pop2007 pop.pop2008 pop.pop2009
       pop.pop2010;
   where county = 'ST';
   select;
      when(agegrp in (' 0-4 ',' 5-9 ')) agegroup = ' 0-9 ';
      when(agegrp in ('10-14','15-19')) agegroup = '10-19';
      when(agegrp in ('20-24','25-29')) agegroup = '20-29';
      when(agegrp in ('30-34','35-39')) agegroup = '30-39';
      when(agegrp in ('40-44','45-49')) agegroup = '40-49';
      when(agegrp in ('50-54','55-59')) agegroup = '50-59';
      when(agegrp in ('60-64','65-69')) agegroup = '60-69';
      when(agegrp in ('70-74','75-79')) agegroup = '70-79';
      when(agegrp in ('80-84','85+  ')) agegroup = '80+  ';
      when(agegrp in ('15-17'))         delete;
   end;
   Flag = '0';
   output;
   Flag = '1';
   output;
   Flag = '2';
   output;
   Flag = '3';
   output;
run;
proc summary data=popfile;
   class year sex agegrp Flag;
   var pop;
   output out=popsumm sum=pop;
run;
/*
rates by year, age group, sex, and Flag value
*/
proc summary data=prelicit1;
   class year sex agegrp Flag;
   output out=flagsumm1(rename=(_freq_=deaths));
run;
data flagsumm2;
   set flagsumm1;
   if sex  = '' then sex = 'T';
run;
proc sort data=flagsumm2;
   by year sex agegrp Flag;
run;
proc sort data=popsumm;
   by year sex agegrp Flag;
run;
data flagrate(drop=_type_ _freq_);
   merge flagsumm2(where=(Flag ne '')) popsumm(where=(Flag ne '' and sex ne ''));
   by year sex agegrp Flag;
   if deaths = . then deaths = 0;
   rate = (deaths/pop)*100000;
   if year = ''   then year = 'Tot ';
   if agegrp = '' then agegrp = 'Total';
run;
proc export data=flagrate 
   outfile = 'c:\user\poisoning\supermicar\analysis\flagrate.dat'
   dbms=csv
   replace
   ;
run;
/*
compute age-adjusted rates also
For this, I need age categorized into 18 age groups.
*/
data prelicit2;
   set sm.TcodeWide(where=(('X40' le underly3 le 'Y19') and st_res = '48'));
   if illicit_flag = 'N' and prescrip_flag = 'N' then flag = '0';
   if illicit_flag = 'Y' and prescrip_flag = 'Y' then flag = '1';
   if illicit_flag = 'N' and prescrip_flag = 'Y' then flag = '2';
   if illicit_flag = 'Y' and prescrip_flag = 'N' then flag = '3';
   select;
      when( 0 le age le 4 ) agegrp = ' 0-4 ';
      when( 5 le age le 9 ) agegrp = ' 5-9 ';
      when(10 le age le 14) agegrp = '10-14';
      when(15 le age le 19) agegrp = '15-19';
      when(20 le age le 24) agegrp = '20-24';
      when(25 le age le 29) agegrp = '25-29';
      when(30 le age le 34) agegrp = '30-34';
      when(35 le age le 39) agegrp = '35-39';
      when(40 le age le 44) agegrp = '40-44';
      when(45 le age le 49) agegrp = '45-49';
      when(50 le age le 54) agegrp = '50-54';
      when(55 le age le 59) agegrp = '55-59';
      when(60 le age le 64) agegrp = '60-64';
      when(65 le age le 69) agegrp = '65-69';
      when(70 le age le 74) agegrp = '70-74';
      when(75 le age le 79) agegrp = '75-79';
      when(80 le age le 84) agegrp = '80-84';
      when(85 le age      ) agegrp = '85+  ';
      end;
   format flag $Flag.;
run;
proc summary data=prelicit2;
   class year sex agegrp flag;
   output out=flagsumm1(rename=(_freq_=deaths));
run;
data flagsumm2(drop=_type_);
   set flagsumm1(where=(_type_ in (11,15)));
   if sex = '' then sex = 'T';
run;
proc sort data=flagsumm2;
   by year flag sex agegrp; 
run;
/*
get population data
*/
data popfile2;
   set pop.pop2003 pop.pop2004 pop.pop2005 pop.pop2006 pop.pop2007 pop.pop2008 pop.pop2009
       pop.pop2010;
   where county = 'ST' and agegrp ne '15-17';
   flag = '0';
   output;
   flag = '1';
   output;
   flag = '2';
   output;
   flag = '3';
   output;
run;
/*
read in the standard population proportions for the US 2000 population with 18 age groups
and merge them with the population file.
*/
data stanpop;
   infile 'c:\data\popln\2000_18agegrp.dat';
   input @9 agegrp $char5. @19 proport 8.6;
run;
proc sort data=popfile2;
   by agegrp year sex flag; 
run;
data popfile3;
   merge popfile2 stanpop;
   by agegrp;
run;
/*
Merge population and death data and compute age-adjusted rates.
*/
proc sort data=popfile3;
   by year flag sex agegrp; 
run;

data adjflagrate(keep=year flag sex totdeath totpop rate stderr glower gupper);
   retain rate maxwt;
   merge flagsumm2 popfile3;
   by year flag sex agegrp; 
   if first.sex then do;
         rate=0;
         totpop=0;
         totdeath=0;
         var2=0;
         maxwt=0;
      end;
   if deaths = . then deaths = 0;
   totpop+pop;
   totdeath+deaths;
   agerate=(deaths/pop);
   rate=rate+(agerate*proport*100000);
   var2+(deaths * (proport/pop)**2);
   if (proport/pop) > maxwt then maxwt = proport/pop;
   if last.sex then do;
         var2     = var2*(100000**2);
         stderr   = sqrt(var2);
         maxwt    = maxwt*100000;
         glower   = (var2/(2*rate))*cinv(0.025,2*(rate**2)/var2);
         gupper   = ((var2 + maxwt**2)/(2*(rate+maxwt)))*
                    cinv(0.975,2*(rate+maxwt)**2/(var2+maxwt**2));
         output;
      end;
run;
/*
change the case of some names to make them easier to use in R
*/
data adjflagrate2(rename=(tyear=year tsex=sex));
   set adjflagrate(rename=(sex=tsex year=tyear));
run;
proc export data=adjflagrate2 
   outfile = 'c:\user\poisoning\supermicar\analysis\adjflagrate.dat'
   dbms=csv
   replace
   ;
run;
/*
also compute the median age for each category
*/
proc univariate data=prelicit1;
   class flag;
   var age;
run;
/*
results
neither:	45y
both:		43y
prescription:	46y
illicit:	43y
*/

\end{lstlisting}

\bfs
<<>>=
flagrate.dat <- read.csv("..\\flagrate.dat",header=T)
adjflagrate.dat <- read.csv("..\\adjflagrate.dat",header=T)

PlotFlagByYear <- function(flag,color=1){
   with(flagrate.dat[flagrate.dat$agegrp=='Total' & flagrate.dat$sex=='T' & 
      flagrate.dat$year!='Tot' & flagrate.dat$Flag==flag,], plot(as.numeric(year),rate,
      xlab='Year',ylab='Rate per 100,000',ylim=c(0,11),xlim=c(1,9),axes=F,col=color,pch=20))
   axis(1,at=c(1:8),labels=c(2003:2010))
   axis(2,las=1)
   box()
   with(flagrate.dat[flagrate.dat$agegrp=='Total' & flagrate.dat$sex=='T' & 
      flagrate.dat$year!='Tot' & flagrate.dat$Flag==flag,], 
      lines(as.numeric(year),loess(rate~as.numeric(year),span=1)$fitted,col=color))
}
AddToPlotFlagByYear <- function(flag,color=2){
   with(flagrate.dat[flagrate.dat$agegrp=='Total' & flagrate.dat$sex=='T' & 
      flagrate.dat$year!='Tot' & flagrate.dat$Flag==flag,], 
      points(as.numeric(year),rate,col=color,pch=20))
   with(flagrate.dat[flagrate.dat$agegrp=='Total' & flagrate.dat$sex=='T' & 
      flagrate.dat$year!='Tot' & flagrate.dat$Flag==flag,], 
      lines(as.numeric(year),loess(rate~as.numeric(year),span=1)$fitted,col=color))
}

PlotAdjFlagByYear <- function(flag,color=1,sex='T'){
#
# plots age-adjusted rates by year
#
   with(adjflagrate.dat[adjflagrate.dat$sex==sex & adjflagrate.dat$flag==flag,], plot(year,rate,
      xlab='Year',ylab='Rate per 100,000',ylim=c(0,11),xlim=c(2003,2011),axes=F,col=color,pch=20,
      type='l',lwd=2))
   axis(1,at=c(2003:2010),labels=c(2003:2010))
   axis(2,las=1)
#   box()
#   with(adjflagrate.dat[adjflagrate.dat$sex==sex & adjflagrate.dat$flag==flag,], 
#      lines(year,rate,col=color))
}
PlotAdjFlagByYear2 <- function(flag,color=1,sex='T'){
#
# plots age-adjusted rates by year
# without y-axis or box
#
   with(adjflagrate.dat[adjflagrate.dat$sex==sex & adjflagrate.dat$flag==flag,], plot(year,rate,
      xlab='Year',ylab='Rate per 100,000',ylim=c(0,11),xlim=c(2003,2011),axes=F,col=color,pch=20,
      type='l',lwd=2))
   axis(1,at=c(2003:2010),labels=c(2003:2010))
#   axis(2,las=1)
#   box()
#   with(adjflagrate.dat[adjflagrate.dat$sex==sex & adjflagrate.dat$flag==flag,], 
#      lines(year,rate,col=color))
}
AddToPlotAdjFlagByYear <- function(flag,color=2,sex='T'){
#   with(adjflagrate.dat[adjflagrate.dat$sex==sex & adjflagrate.dat$flag==flag,], 
#      points(year,rate,col=color,pch=20))
   with(adjflagrate.dat[adjflagrate.dat$sex==sex & adjflagrate.dat$flag==flag,], 
      lines(year,rate,col=color,lwd=2))
}

PlotFlagByAgeSex <- function(flag,color=1,sex='T',ymax=13){
   with(flagrate.dat[flagrate.dat$agegrp!='Total' & flagrate.dat$sex==sex & 
      flagrate.dat$year=='Tot' & flagrate.dat$Flag==flag,], plot(1:9,rate,
      xlab='Age group',ylab='Rate per 100,000',ylim=c(0,ymax),xlim=c(1,10),axes=F,col=color,pch=20,
      type='l',lwd=2))
   axis(1,at=c(1:9),labels=c('0-9','10-19','20-29','30-39','40-49','50-59','60-69','70-79','80+'))
   axis(2,las=1)
#   box()
#   with(flagrate.dat[flagrate.dat$agegrp!='Total' & flagrate.dat$sex==sex & 
#      flagrate.dat$year=='Tot' & flagrate.dat$Flag==flag,], 
#      lines(1:9,rate,col=color))
}
PlotFlagByAgeSex2 <- function(flag,color=1,sex='T',ymax=13){
#
# y-axis is not plotted here
#
   with(flagrate.dat[flagrate.dat$agegrp!='Total' & flagrate.dat$sex==sex & 
      flagrate.dat$year=='Tot' & flagrate.dat$Flag==flag,], plot(1:9,rate,
      xlab='Age group',ylab='',ylim=c(0,ymax),xlim=c(1,10),axes=F,col=color,pch=20,
      type='l',lwd=2))
   axis(1,at=c(1:9),labels=c('0-9','10-19','20-29','30-39','40-49','50-59','60-69','70-79','80+'))
#   box()
#   with(flagrate.dat[flagrate.dat$agegrp!='Total' & flagrate.dat$sex==sex & 
#      flagrate.dat$year=='Tot' & flagrate.dat$Flag==flag,], 
#      lines(1:9,rate,col=color))
}
AddToPlotFlagByAgeSex <- function(flag,color=1,sex='T'){
#   with(flagrate.dat[flagrate.dat$agegrp!='Total' & flagrate.dat$sex==sex & 
#      flagrate.dat$year=='Tot' & flagrate.dat$Flag==flag,], points(1:9,rate,col=color,pch=20))
   with(flagrate.dat[flagrate.dat$agegrp!='Total' & flagrate.dat$sex==sex & 
      flagrate.dat$year=='Tot' & flagrate.dat$Flag==flag,], 
      lines(1:9,rate,col=color,lwd=2))
}
@
\efs


\begin{figure}
<<plotflagbyyear1,fig=T,echo=F,height=7.5,width=5>>=
PlotFlagByYear('Prescription')
AddToPlotFlagByYear('Illicit',color=2)
AddToPlotFlagByYear('Both',color=3)
AddToPlotFlagByYear('Neither',color=4)
text(8.6,9.2,'Prescription',cex=0.8)
text(8.6,2.0,'Illicit',cex=0.8)
text(8.6,1.4,'Both',cex=0.8)
text(8.6,2.8,'Neither',cex=0.8)
@
\caption{\label{plotflagbyyear1}Crude rates of poisoning deaths according to the category of drugs 
named on the death certificate, per 100,000 population.}
\end{figure}

\begin{figure}
<<plotflagbyyear2,fig=T,echo=F,height=10,width=7.5>>=
PlotAdjFlagByYear('Prescription')
AddToPlotAdjFlagByYear('Illicit',color=2)
AddToPlotAdjFlagByYear('Both',color=3)
AddToPlotAdjFlagByYear('Neither',color=4)
text(2010.6,8.7,'Prescription',cex=0.8)
text(2010.6,2.0,'Illicit',cex=0.8)
text(2010.6,1.3,'Both',cex=0.8)
text(2010.6,2.7,'Neither',cex=0.8)
@
\caption{\label{plotflagbyyear2}Age-adjusted rates of poisoning deaths according to the 
category of drugs named on the death certificate, per 100,000 population.} 
\end{figure}


\begin{figure}
<<plotflagbyage1,fig=T,echo=F,height=10,width=7.5>>=
PlotFlagByAgeSex('Prescription',ymax=18)
AddToPlotFlagByAgeSex('Illicit',color=2)
AddToPlotFlagByAgeSex('Both',color=3)
AddToPlotFlagByAgeSex('Neither',color=4)
legend(8,18,legend=c('Prescription','Illicit','Both','Neither'),
   col=c(1,2,3,4),lty=c(1,1,1,1))
@
\caption{\label{plotflagbyage1}Age-specific rates of poisoning deaths according to the category of drugs 
named on the death certificate, by age group, per 100,000 population.}
\end{figure}

\end{detail}

\begin{figure}
<<plotflagbyyear3,fig=T,echo=F,height=5,width=7.5>>=
savepar <- par(mfrow=c(1,3),oma=c(5,5,4,2),mar=c(0,0,0,0))
PlotAdjFlagByYear('Prescription',sex='T')
AddToPlotAdjFlagByYear('Illicit',sex='T',color=2)
AddToPlotAdjFlagByYear('Both',sex='T',color=3)
AddToPlotAdjFlagByYear('Neither',sex='T',color=4)
mtext('Rate per 100,000', side=2,line=3.5)
mtext('Year',side=1,line=3)
title('Both sexes',line=-1)
legend(2003,1.5,legend=c('Prescription','Illicit','Both','Neither'),
   col=c(1,2,3,4),lty=c(1,1,1,1),lwd=c(2,2,2,2))

PlotAdjFlagByYear2('Prescription',sex='M')
AddToPlotAdjFlagByYear('Illicit',sex='M',color=2)
AddToPlotAdjFlagByYear('Both',sex='M',color=3)
AddToPlotAdjFlagByYear('Neither',sex='M',color=4)
mtext('Year',side=1,line=3)
title('Men',line=-1)
PlotAdjFlagByYear2('Prescription',sex='F')
AddToPlotAdjFlagByYear('Illicit',sex='F',color=2)
AddToPlotAdjFlagByYear('Both',sex='F',color=3)
AddToPlotAdjFlagByYear('Neither',sex='F',color=4)
title('Women',line=-1)
mtext('Year',side=1,line=3)

par(savepar)
@ 
\caption{\label{plotflagbyyear3}Age-adjusted rates of poisoning deaths according to the category of 
drugs named on the death certificate, by sex and year, per 100,000 population.} 
\end{figure}


\begin{figure}
<<plotflagbyage2,fig=T,echo=F,height=6,width=7.5>>=
savepar <- par(mfrow=c(1,3),oma=c(5,5,4,2),mar=c(0,0,0,0))
PlotFlagByAgeSex('Prescription',sex='T',ymax=22)
AddToPlotFlagByAgeSex('Illicit',sex='T',color=2)
AddToPlotFlagByAgeSex('Both',sex='T',color=3)
AddToPlotFlagByAgeSex('Neither',sex='T',color=4)
mtext('Rate per 100,000', side=2,line=3.5)
mtext('Age group',side=1,line=3)
title('Both sexes',line=-1)

PlotFlagByAgeSex2('Prescription',sex='M',ymax=22)
AddToPlotFlagByAgeSex('Illicit',sex='M',color=2)
AddToPlotFlagByAgeSex('Both',sex='M',color=3)
AddToPlotFlagByAgeSex('Neither',sex='M',color=4)
mtext('Age group',side=1,line=3)
title('Men',line=-1)

PlotFlagByAgeSex2('Prescription',sex='F',ymax=22)
AddToPlotFlagByAgeSex('Illicit',sex='F',color=2)
AddToPlotFlagByAgeSex('Both',sex='F',color=3)
AddToPlotFlagByAgeSex('Neither',sex='F',color=4)
title('Women',line=-1)
mtext('Age group',side=1,line=3)
legend(5.5,21.5,legend=c('Prescription','Illicit','Both','Neither'),
   col=c(1,2,3,4),lty=c(1,1,1,1),lwd=c(2,2,2,2))

par(savepar)
@ 
\caption{\label{plotflagbyage2}Age-specific rates of poisoning deaths according to the category of 
drugs named on the death certificate, by sex and age group, per 100,000 population.} 
\end{figure}

\clearpage
\begin{detail}

Here I will make lists of the top five substances named for each underlying cause of death (3 digit 
level) from X40 to Y19. (In the paper I may decide to report only a subset of the causes of death, 
perhaps X40--X44, X60--X64, and Y10--Y14.) I will start with the file TcodeLong2, which includes 
Washington residents with cause of death between X40 and Y19, and from which the drugword 
``opiate'' has been removed when there is a more specific opiate named on the record.

I will include in the list the causes-of-death that have at least 25 deaths (probably in the paper 
I will further restrict to causes with at least 50 deaths).

\begin{lstlisting}[language=sas,caption=Top five for each c-o-d]
libname sm  'c:\data\poisoning\SuperMICAR';
%include "c:\user\poisoning\SuperMICAR\generic.sas";
proc sort data=sm.TcodeLong2;
   by underly3;
run;
/*
get numbers of each underlying cause of death
*/
proc freq data=sm.TcodeWide;
   where 'X40' le underly3 le 'Y19' and st_res = '48';
   tables underly3;
run;
/*
get numbers for each drug word for each cause-of-death
*/
proc freq data=sm.TcodeLong2 noprint;
   by underly3;
   tables drugword_genname/out=list1;
run;
proc sort data=list1;
   by underly3 descending count;
run;
data list2;
   set list1;
   by underly3;
   if first.underly3 then i = 0;
   if drugword_genname in ('DRUG','MEDICATION','PRESCRIPTION','ALCOHOLISM') then delete;
   if i le 10 then do;
      output;
      i+1;
      end;
run;
proc print data=list2 uniform;
   by underly3;
run;    
\end{lstlisting}

\bfs
\bvm
               Underlying cause of death (3 dgt)
                                      Cumulative    Cumulative
 UNDERLY3    Frequency     Percent     Frequency      Percent
 -------------------------------------------------------------
 X40               38        0.49            38         0.49
 X41              470        6.01           508         6.50
 X42             2308       29.53          2816        36.02
 X43                5        0.06          2821        36.09
 X44             2708       34.64          5529        70.73
 X45              162        2.07          5691        72.80
 X46               12        0.15          5703        72.96
 X47              123        1.57          5826        74.53
 X48                5        0.06          5831        74.59
 X49               19        0.24          5850        74.84
 X60               46        0.59          5896        75.43
 X61              253        3.24          6149        78.66
 X62              116        1.48          6265        80.15
 X63                2        0.03          6267        80.17
 X64              650        8.32          6917        88.49
 X65                8        0.10          6925        88.59
 X66               26        0.33          6951        88.92
 X67              338        4.32          7289        93.25
 X68                7        0.09          7296        93.34
 X69               15        0.19          7311        93.53
 X85               11        0.14          7322        93.67
 Y10               18        0.23          7340        93.90
 Y11               49        0.63          7389        94.52
 Y12              142        1.82          7531        96.34
 Y14              242        3.10          7773        99.44
 Y15               11        0.14          7784        99.58
 Y16                4        0.05          7788        99.63
 Y17               21        0.27          7809        99.90
 Y19                8        0.10          7817       100.00



\end{verbatim}
\efs

Same thing for T-codes. As I did for the underlying cause codes, I will start with the file 
TcodeLong2, which includes deaths coded X40 to Y19, excludes out-of-state residents, and excludes 
the drugword  ``opiate'' when there is a specific opiate also mentioned on the death record.

This analysis uses the T-codes that I derived from the drug names, not the original T-codes in the 
multiple cause axis, because I want to report what named drugs are associated with each T-code.

\begin{lstlisting}[language=sas,caption=Top five for each T code]
libname sm  'c:\data\poisoning\SuperMICAR';
%include "c:\user\poisoning\SuperMICAR\generic.sas";
proc sort data=sm.TcodeLong2 out=tdeaths nodupkey;
   by certno Tcode;
run;
/*
get numbers of each T-code
*/
proc freq data=tdeaths;
   where 'T36  ' le Tcode le 'T65.9';
   tables Tcode/out=list0;
run;
/*
get numbers for each drug word for each cause-of-death
*/
proc freq data=sm.TcodeLong2 noprint;
   where 'T36  ' le Tcode le 'T65.9';
   by tcode;
   tables drugword_genname/out=list1;
run;
proc sort data=list1;
   by Tcode descending count;
run;
data list2(drop=i);
   set list1;
   by Tcode;
   if first.Tcode then i = 0;
   if drugword_genname in ('DRUG','MEDICATION','PRESCRIPTION','ALCOHOLISM') then delete;
   if i le 10 then do;
      output;
      i+1;
      end;
run;
data list3;
   merge list0(rename=(count=TcodeCount) drop=percent) list2;
   by Tcode;
run;
options ps=120 ls=80;
proc print data=list3 uniform;
   where TcodeCount ge 100;
   by Tcode;
run;    
\end{lstlisting}

\bfs
\bvm
The SAS System                   15:04 Monday, April 22, 2013  54

                The FREQ Procedure
                                     Cumulative    Cumulative
  Tcode    Frequency     Percent     Frequency      Percent
                                                             ----------------------------------------------------------
   T36.0           6        0.03             6         0.03
   T36.1           1        0.01             7         0.04
   T36.5           1        0.01             8         0.05
   T36.6           1        0.01             9         0.05
   T36.7           1        0.01            10         0.06
   T36.8           2        0.01            12         0.07
   T37.1           2        0.01            14         0.08
   T37.2           3        0.02            17         0.10
   T37.5           2        0.01            19         0.11
   T37.8           3        0.02            22         0.13
   T38.3          34        0.20            56         0.33
   T38.7           1        0.01            57         0.33
   T39.0          54        0.31           111         0.65
   T39.1         395        2.30           506         2.94
   T39.2           9        0.05           515         2.99
   T39.3          59        0.34           574         3.34
   T39.9           1        0.01           575         3.34
   T40.0           2        0.01           577         3.35
   T40.1         539        3.13          1116         6.49
   T40.2        2725       15.84          3841        22.32
   T40.3        2149       12.49          5990        34.82
   T40.4         521        3.03          6511        37.84
   T40.5        1175        6.83          7686        44.67
   T40.6          83        0.48          7769        45.16
   T40.7          36        0.21          7805        45.36
   T41.0          13        0.08          7818        45.44
   T41.1           7        0.04          7825        45.48
   T41.2          10        0.06          7835        45.54
   T41.3          17        0.10          7852        45.64
   T42.0          24        0.14          7876        45.78
   T42.1          52        0.30          7928        46.08
   T42.3         100        0.58          8028        46.66
   T42.4        1311        7.62          9339        54.28
   T42.6         436        2.53          9775        56.81
   T42.7          15        0.09          9790        56.90
   T42.8         180        1.05          9970        57.95
   T43.0         795        4.62         10765        62.57
   T43.1           1        0.01         10766        62.57
   T43.2        1516        8.81         12282        71.39
   T43.3         122        0.71         12404        72.10
   T43.4           2        0.01         12406        72.11
   T43.5         464        2.70         12870        74.80
   T43.6         768        4.46         13638        79.27
   T43.8           3        0.02         13641        79.29
   T44.3           2        0.01         13643        79.30
   T44.7          21        0.12         13664        79.42
   T44.9          19        0.11         13683        79.53
   T45.0         680        3.95         14363        83.48
   T45.1          20        0.12         14383        83.60
   T45.5          15        0.09         14398        83.68
   T45.7           1        0.01         14399        83.69
   T46.0           6        0.03         14405        83.73
   T46.1          76        0.44         14481        84.17
   T46.2          17        0.10         14498        84.27
   T46.3           1        0.01         14499        84.27
   T46.4           2        0.01         14501        84.28
   T46.5           2        0.01         14503        84.30
   T46.6           2        0.01         14505        84.31
   T48.1         220        1.28         14725        85.59
   T48.3         139        0.81         14864        86.39
   T48.4          14        0.08         14878        86.47
   T48.6           2        0.01         14880        86.49
   T48.9          37        0.22         14917        86.70
   T50.1           1        0.01         14918        86.71
   T50.2           1        0.01         14919        86.71
   T50.4           4        0.02         14923        86.74
   T50.5           6        0.03         14929        86.77
   T50.6           1        0.01         14930        86.78
   T50.7           1        0.01         14931        86.78
   T50.9          56        0.33         14987        87.11
   T51.0        1446        8.40         16433        95.51
   T51.1           5        0.03         16438        95.54
   T51.2          11        0.06         16449        95.61
   T51.8          31        0.18         16480        95.79
   T52.0           6        0.03         16486        95.82
   T52.1           1        0.01         16487        95.83
   T52.2           3        0.02         16490        95.84
   T52.8           1        0.01         16491        95.85
   T53.1           2        0.01         16493        95.86
   T53.2           1        0.01         16494        95.87
   T53.4           1        0.01         16495        95.87
   T53.5           1        0.01         16496        95.88
   T53.6          21        0.12         16517        96.00
   T53.7           2        0.01         16519        96.01
   T53.9           1        0.01         16520        96.02
   T54.2           4        0.02         16524        96.04
   T54.3           2        0.01         16526        96.05
   T56.8          17        0.10         16543        96.15
   T58           451        2.62         16994        98.77
   T59.0           3        0.02         16997        98.79
   T59.6           1        0.01         16998        98.80
   T59.8          49        0.28         17047        99.08
   T59.9         115        0.67         17162        99.75
   T60.0           2        0.01         17164        99.76
   T60.3           3        0.02         17167        99.78
   T65.0           4        0.02         17171        99.80
   T65.1           2        0.01         17173        99.81
   T65.2          10        0.06         17183        99.87
   T65.3           1        0.01         17184        99.88
   T65.9          21        0.12         17205       100.00



                                     The SAS System   12:43 Friday, July 6, 2012  75

-------------------------------- Tcode=T39.1 ----------------------------------

                 Tcode
          Obs    Count    drugword_genname          COUNT    PERCENT

           23      395    ACETAMINOPHEN               395     99.747
           24      395    ANALGESIC                     1      0.253


-------------------------------- Tcode=T40.1 ----------------------------------

                 Tcode
          Obs    Count    drugword_genname          COUNT    PERCENT

           33      539    HEROIN                      539    100.000


-------------------------------- Tcode=T40.2 ----------------------------------

                 Tcode
          Obs    Count    drugword_genname          COUNT    PERCENT

           34     2725    OXYCODONE                  1047     32.435
           35     2725    MORPHINE                    648     20.074
           36     2725    HYDROCODONE                 563     17.441
           37     2725    OPIATE                      543     16.822
           38     2725    HYDROMORPHONE               269      8.333
           39     2725    CODEINE                     148      4.585
           40     2725    OXYMORPHONE                   6      0.186
           41     2725    DIHYDROCODEINE                3      0.093
           42     2725    TAPENTADOL                    1      0.031


-------------------------------- Tcode=T40.3 ----------------------------------

                 Tcode
          Obs    Count    drugword_genname          COUNT    PERCENT

           43     2149    METHADONE                  2149    100.000


-------------------------------- Tcode=T40.4 ----------------------------------

                 Tcode
          Obs    Count    drugword_genname          COUNT    PERCENT

           44      521    FENTANYL                    198     36.735
           45      521    TRAMADOL                    153     28.386
           46      521    PROPOXYPHENE                141     26.160
           47      521    MEPERIDINE                   36      6.679
           48      521    BUPRENORPHINE                 5      0.928
           49      521    PENTAZOCINE                   4      0.742
           50      521    SUFENTANIL                    2      0.371


-------------------------------- Tcode=T40.5 ----------------------------------

                 Tcode
          Obs    Count    drugword_genname          COUNT    PERCENT

           51     1175    COCAINE                    1174     99.072
           52     1175    COCAETHYLENE                 11      0.928


-------------------------------- Tcode=T42.3 ----------------------------------

                 Tcode
          Obs    Count    drugword_genname          COUNT    PERCENT

           75      100    BUTALBITAL                   47     46.078
           76      100    PHENOBARBITAL                36     35.294
           77      100    BARBITURATE                   7      6.863
           78      100    PENTOBARBITAL                 6      5.882
           79      100    SECOBARBITAL                  4      3.922
           80      100    BUTABARBITAL                  2      1.961


-------------------------------- Tcode=T42.4 ----------------------------------

                 Tcode
          Obs    Count    drugword_genname          COUNT    PERCENT

           81     1311    DIAZEPAM                    468     30.350
           82     1311    ALPRAZOLAM                  412     26.719
           83     1311    BENZODIAZEPINE              163     10.571
           84     1311    CLONAZEPAM                  120      7.782
           85     1311    TEMAZEPAM                   114      7.393
           86     1311    LORAZEPAM                   109      7.069
           87     1311    CHLORDIAZEPOXIDE             45      2.918
           88     1311    NORDIAZEPAM                  39      2.529
           89     1311    OXAZEPAM                     35      2.270
           90     1311    CLOZAPINE                    12      0.778
           91     1311    FLURAZEPAM                   12      0.778


-------------------------------- Tcode=T42.6 ----------------------------------

                 Tcode
          Obs    Count    drugword_genname          COUNT    PERCENT

           92      436    GABAPENTIN                  152     32.340
           93      436    ZOLPIDEM                    145     30.851
           94      436    TOPIRAMATE                   64     13.617
           95      436    LAMOTRIGINE                  54     11.489
           96      436    VALPROIC ACID                34      7.234
           97      436    LEVETIRACETAM                 7      1.489
           98      436    ZOPICLONE                     5      1.064
           99      436    VALPROATE                     3      0.638
          100      436    ZONISAMIDE                    2      0.426
          101      436    CHLORAL HYDRATE               1      0.213
          102      436    PRIMIDONE                     1      0.213

                                The SAS System   12:43 Friday, July 6, 2012  76

-------------------------------- Tcode=T42.8 ----------------------------------

                 Tcode
          Obs    Count    drugword_genname          COUNT    PERCENT

          106      180    CARISOPRODOL                139     74.332
          107      180    METHOCARBAMOL                34     18.182
          108      180    AMANTADINE                    6      3.209
          109      180    MUSCLE RELAXANT               5      2.674
          110      180    ORPHENADRINE                  2      1.070
          111      180    METAXALONE                    1      0.535


-------------------------------- Tcode=T43.0 ----------------------------------

                 Tcode
          Obs    Count    drugword_genname          COUNT    PERCENT

          112      795    AMITRIPTYLINE               397     44.859
          113      795    DOXEPIN                     143     16.158
          114      795    NORTRIPTYLINE               143     16.158
          115      795    MIRTAZEPINE                 130     14.689
          116      795    IMIPRAMINE                   32      3.616
          117      795    CLOMIPRAMINE                 12      1.356
          118      795    DESIPRAMINE                  11      1.243
          119      795    TRICYCLIC                    10      1.130
          120      795    DESMETHYLDOXEPIN              4      0.452
          121      795    AMOXAPINE                     2      0.226
          122      795    MAPROTILINE                   1      0.113


-------------------------------- Tcode=T43.2 ----------------------------------

                 Tcode
          Obs    Count    drugword_genname          COUNT    PERCENT

          124     1516    CITALOPRAM                  533     30.198
          125     1516    FLUOXETINE                  243     13.768
          126     1516    TRAZODONE                   227     12.861
          127     1516    VENLAFAXINE                 220     12.465
          128     1516    SERTRALINE                  192     10.878
          129     1516    BUPROPION                   169      9.575
          130     1516    PAROXETINE                  137      7.762
          131     1516    ANTIDEPRESSANT               28      1.586
          132     1516    NORFLUOXETINE                 9      0.510
          133     1516    DESVENLAFAXINE                2      0.113
          134     1516    DULOXETINE                    2      0.113


-------------------------------- Tcode=T43.3 ----------------------------------

                 Tcode
          Obs    Count    drugword_genname          COUNT    PERCENT

          135      122    PROMETHAZINE                113     91.129
          136      122    CHLORPROMAZINE                6      4.839
          137      122    THIORIDAZINE                  3      2.419
          138      122    MESORIDAZINE                  1      0.806
          139      122    PROCHLORPERAZINE              1      0.806


-------------------------------- Tcode=T43.5 ----------------------------------

                 Tcode
          Obs    Count    drugword_genname          COUNT    PERCENT

          141      464    QUETIAPINE                  199     40.947
          142      464    MEPROBAMATE                 122     25.103
          143      464    HYDROXYZINE                  79     16.255
          144      464    OLANZAPINE                   73     15.021
          145      464    BUSPIRONE                    10      2.058
          146      464    RISPERIDONE                   2      0.412
          147      464    PALIPERIDONE                  1      0.206


-------------------------------- Tcode=T43.6 ----------------------------------

                 Tcode
          Obs    Count    drugword_genname          COUNT    PERCENT

          148      768    METHAMPHETAMINE             681     85.125
          149      768    AMPHETAMINE                  63      7.875
          150      768    MDMA                         25      3.125
          151      768    METHYLPHENIDATE              17      2.125
          152      768    CAFFEINE                      9      1.125
          153      768    STIMULANT                     4      0.500
          154      768    METHYLENEDIOXY                1      0.125


-------------------------------- Tcode=T45.0 ----------------------------------

                 Tcode
          Obs    Count    drugword_genname          COUNT    PERCENT

          165      680    DIPHENHYDRAMINE             574     78.846
          166      680    DOXYLAMINE                   94     12.912
          167      680    CHLORPHENIRAMINE             33      4.533
          168      680    METOCLOPRAMIDE               16      2.198
          169      680    MECLIZINE                     4      0.549
          170      680    ANTIHISTAMINE                 2      0.275
          171      680    BROMPHENIRAMINE               2      0.275
          172      680    CHLORCYCLIZINE                1      0.137
          173      680    DRAMAMINE                     1      0.137
          174      680    TRIPROLIDINE                  1      0.137


-------------------------------- Tcode=T48.1 ----------------------------------

                 Tcode
          Obs    Count    drugword_genname          COUNT    PERCENT

          202      220    CYCLOBENZAPRINE             220    100.000

                                The SAS System   12:43 Friday, July 6, 2012  77

-------------------------------- Tcode=T48.3 ----------------------------------

                 Tcode
          Obs    Count    drugword_genname          COUNT    PERCENT

          203      139    DEXTROMETHORPHAN            139    100.000


-------------------------------- Tcode=T51.0 ----------------------------------

                 Tcode
          Obs    Count    drugword_genname          COUNT    PERCENT

          214     1446    ALCOHOL                    1446     99.862
          215     1446    BEER                          1      0.069
          216     1446    TEQUILA                       1      0.069


--------------------------------- Tcode=T58 -----------------------------------

                 Tcode
          Obs    Count    drugword_genname          COUNT    PERCENT

          248      451    CARBON MONOXIDE             394     65.124
          249      451    VEHICLE EXHAUST             158     26.116
          250      451    ENGINE EXHAUST               28      4.628
          251      451    PRODUCTS OF COMBUSTION       23      3.802
          252      451    CARBON ASPHYXIATION           1      0.165
          253      451    CARBON EXHAUST                1      0.165


-------------------------------- Tcode=T59.9 ----------------------------------

                 Tcode
          Obs    Count    drugword_genname          COUNT    PERCENT

          267      115    FUMES                       106     91.379
          268      115    AEROSOL                       6      5.172
          269      115    INERT GAS                     4      3.448

\end{verbatim}
\efs

\end{detail}

\begin{screen}
   \onecolumn
\end{screen}

\begin{table}
\begin{small}
\caption{\label{codlist}Most commonly listed substances for each cause of death, for causes with at 
least 25 deaths.}
   \begin{tabular}{lp{1.5in}rp{4in}} \hline
\multicolumn{2}{l}{Cause of death} & & \\
ICD-10 & description & N & top 5 named substances (number) \\ \hline
X40 &\rr unintentional; nonopioid analgesics, antipyretics and antirheumatics                                 &    38  & acetaminophen    (27), tramadol          (5), alcohol           (4), salicylate        (2), aspirin           (1) \\
X41 &\rr unintentional; antiepileptic, sedative-hypnotic, antiparkinsonism and psychotropic drugs, NEC        &   470  & methamphetamine (279), alcohol          (78), citalopram       (34), amitriptyline    (29), fluoxetine       (14) \\
X42 &\rr unintentional; narcotics and psychodysleptics (hallucinogens), NEC                                   & 2,308  & methadone       (894), cocaine         (651), alcohol         (509), heroin          (347), oxycodone       (281) \\
X44 &\rr unintentional; other and unspecified drugs                                                           & 2,708  & methadone     (1,042), oxycodone       (584), alcohol         (445), cocaine         (429), diazepam        (379) \\
X45 &\rr unintentional; alcohol                                                                               &   162  & alcohol         (140), opiate            (3), amitriptyline     (2), isopropanol       (2), methanol          (2) \\
X47 &\rr unintentional; other gases and vapors                                                                &   123  & carbon monoxide  (90), fumes            (17), propane          (15), smoke inhalation (14), vehicle exhaust  (13) \\
X60 &\rr intentional self-harm; nonopioid analgesics, antipyretics and antirheumatics                         &    46  & acetaminophen    (32), salicylate       (14), aspirin           (6), alcohol           (2), diphenhydramine   (2) \\
X61 &\rr intentional self-harm; antiepileptic, sedative-hypnotic, antiparkinsonism and psychotropic drugs, NEC&   253  & amitriptyline    (52), alcohol          (48), quetiapine       (37), bupropion        (25), citalopram       (24) \\
X62 &\rr intentional self-harm; narcotics and psychodysleptics (hallucinogens), NEC                           &   116  & methadone        (29), oxycodone        (22), alcohol          (21), morphine         (20), opiate           (14) \\
X64 &\rr intentional self-harm; other and unspecified drugs                                                   &   650  & diphenhydramine (141), acetaminophen   (138), alcohol         (112), oxycodone       (104), hydrocodone      (83) \\
X66 &\rr intentional self-harm; organic solvents and halogenated hydrocarbons and their vapors                &    26  & ethylene glycol           (20), antifreeze        (8), benzene           (1), chloroform        (1) \\
X67 &\rr intentional self-harm; other gases and vapors                                                        &   338  & carbon monoxide (279), vehicle exhaust (133), fumes            (82), engine exhaust   (20), alcohol           (9) \\
Y11 &\rr undetermined intent; antiepileptic, sedative-hypnotic, antiparkinsonism and psychotropic drugs, NEC  &    49  & methamphetamine  (14), alcohol           (6), olanzapine        (5), quetiapine        (5), bupropion         (4) \\
Y12 &\rr undetermined intent; narcotics and psychodysleptics (hallucinogens), NEC                             &   142  & methadone        (50), cocaine          (29), heroin           (20), alcohol          (18), morphine         (18) \\
Y14 &\rr undetermined intent; other and unspecified drugs                                                     &   242  & methadone        (71), diphenhydramine  (39), alcohol          (32), methamphetamine  (31), oxycodone        (31) \\
\hline
\end{tabular}

The word ``opiate'' is counted only when a specific opiate is not named on the death record.
\end{small}
\end{table}

\begin{table}
\begin{small}
\caption{\label{tcodelist}Most commonly listed substances for each ICD poisoning injury code, for codes  
associated with at least 100 deaths.}
\begin{tabular}{lp{1.5in}rp{4in}} \hline
\multicolumn{2}{l}{Injury code} & & \\
ICD-10 & description & N & commonly named substances (number) \\ \hline
T39.1  &\rr 4-aminophenol derivatives                                         &  395 & acetaminophen       (395) \\
T40.1  &\rr heroin                                                            &  539 & heroin              (539) \\
T40.2  &\rr other opioids                                                     & 2725 & oxycodone         (1,047), morphine            (648), hydrocodone         (563), opiate              (543), hydromorphone       (269), codeine             (148) \\
T40.3  &\rr methadone                                                         & 2149 & methadone         (2,149) \\
T40.4  &\rr other synthetic narcotics                                         &  521 & fentanyl            (198), tramadol            (153), propoxyphene        (141) \\
T40.5  &\rr cocaine                                                           & 1175 & cocaine           (1,174) \\
T42.3  &\rr barbiturates                                                      &  100 & butalbital           (47), phenobarbital        (36) \\
T42.4  &\rr benzodiazepines                                                   & 1311 & diazepam            (468), alprazolam          (412), benzodiazepine      (163), clonazepam          (120), temazepam           (114), lorazepam           (109) \\
T42.6  &\rr other antiepileptic and sedative-hypnotic drugs                   &  436 & gabapentin          (152), zolpidem            (145), topiramate           (64), lamotrigine          (54) \\
T42.8  &\rr antiparkinsonism drugs and other central muscle-tone depressants  &  180 & carisoprodol        (139), methocarbamol        (34) \\
T43.0  &\rr tricyclic and tetracyclic antidepressants                         &  795 & amitriptyline       (397), doxepin             (143), nortriptyline       (143), mirtazepine         (130) \\
T43.2  &\rr other and unspecified antidepressants                             & 1516 & citalopram          (533), fluoxetine          (243), trazodone           (227), venlafaxine         (220), sertraline          (192), bupropion           (169), paroxetine          (137) \\
T43.3  &\rr phenothiazine antipsychotics and neuroleptics                     &  122 & promethazine        (113) \\
T43.5  &\rr butyrophenone and thioxanthene neuroleptics                       &  464 & quetiapine          (199), meprobamate         (122), hydroxyzine          (79), olanzapine           (73) \\
T43.6  &\rr psychostimulants with abuse potential                             &  768 & methamphetamine     (681), amphetamine          (63) \\
T45.0  &\rr antiallergic and antiemetic drugs                                 &  680 & diphenhydramine     (574), doxylamine           (94) \\
T48.1  &\rr skeletal muscle relaxants                                         &  220 & cyclobenzaprine     (220) \\
T48.3  &\rr antitussives                                                      &  139 & dextromethorphan    (139) \\
T51.0  &\rr ethanol                                                           & 1446 & alcohol           (1,446) \\
T58    &\rr carbon monoxide                                                   &  451 & carbon monoxide     (394), vehicle exhaust     (158) \\
T59.9  &\rr gases, fumes, and vapors, unspecified                             &  115 & fumes               (106) \\
\hline
\end{tabular}

The word ``opiate'' is counted only when a specific opiate is not named on the death record.
\end{small}
\end{table}

\begin{screen}
   \twocolumn
\end{screen}

\begin{detail}
Compute age-adjusted rates of the frequency of which the top 15 drugs are mentioned, by year, 
and by sex. 

\begin{lstlisting}[language=sas,caption=Compute rates by year age and sex]
libname sm  'c:\data\poisoning\SuperMICAR';
%include "c:\user\poisoning\SuperMICAR\generic.sas";
/*
tabulate the population data. 
*/
data popfile;
   set pop.pop2003 pop.pop2004 pop.pop2005 pop.pop2006 pop.pop2007 pop.pop2008 pop.pop2009
       pop.pop2010;
   where county = 'ST' and agegrp ne '15-17';
   drugname = 'METHADONE      ';
   output;
   drugname = 'ALCOHOL        ';
   output;
   drugname = 'COCAINE        ';
   output;
   drugname = 'OXYCODONE      ';
   output;
   drugname = 'METHAMPHETAMINE';
   output;
   drugname = 'MORPHINE       ';
   output;
   drugname = 'DIPHENHYDRAMINE';
   output;
   drugname = 'HYDROCODONE    ';
   output;
   drugname = 'OPIATE         ';
   output;
   drugname = 'HEROIN         ';
   output;
   drugname = 'CITALOPRAM     ';
   output;
   drugname = 'DIAZEPAM       ';
   output;
   drugname = 'ALPRAZOLAM     ';
   output;
   drugname = 'AMITRIPTYLINE  ';
   output;
   drugname = 'ACETAMINOPHEN  ';
   output;
run;
/*
rates by year, age group, sex, and drugname
*/
data drug1;
   set sm.TcodeLong2(where=(top15='Y'));
   select;
      when( 0 le age le 4 ) agegrp = ' 0-4 ';
      when( 5 le age le 9 ) agegrp = ' 5-9 ';
      when(10 le age le 14) agegrp = '10-14';
      when(15 le age le 19) agegrp = '15-19';
      when(20 le age le 24) agegrp = '20-24';
      when(25 le age le 29) agegrp = '25-29';
      when(30 le age le 34) agegrp = '30-34';
      when(35 le age le 39) agegrp = '35-39';
      when(40 le age le 44) agegrp = '40-44';
      when(45 le age le 49) agegrp = '45-49';
      when(50 le age le 54) agegrp = '50-54';
      when(55 le age le 59) agegrp = '55-59';
      when(60 le age le 64) agegrp = '60-64';
      when(65 le age le 69) agegrp = '65-69';
      when(70 le age le 74) agegrp = '70-74';
      when(75 le age le 79) agegrp = '75-79';
      when(80 le age le 84) agegrp = '80-84';
      when(85 le age      ) agegrp = '85+  ';
      end;
run;
proc summary data=drug1;
   class year sex agegrp drugword_genname;
   output out=namesumm1(rename=(_freq_=deaths drugword_genname=drugname));
run;
data namesumm2(drop=_type_);
   set namesumm1(where=(_type_ in (11,15)));
   if sex = '' then sex = 'T';
run;
proc sort data=namesumm2;
   by year drugname sex agegrp; 
run;
/*
read in the standard population proportions for the US 2000 population with 18 age groups
and merge them with the population file.
*/
data stanpop;
   infile 'c:\data\popln\2000_18agegrp.dat';
   input @9 agegrp $char5. @19 proport 8.6;
run;
proc sort data=popfile;
   by agegrp year sex drugname; 
run;
data popfile2;
   merge popfile stanpop;
   by agegrp;
run;
/*
Merge population and death data and compute age-adjusted rates.
*/
proc sort data=popfile2;
   by year drugname sex agegrp; 
run;

data ageadjustedrate(keep=year drugname sex totdeath totpop rate stderr glower gupper);
   retain rate maxwt;
   merge namesumm2 popfile2;
   by year drugname sex agegrp; 
   if first.sex then do;
         rate=0;
         totpop=0;
         totdeath=0;
         var2=0;
         maxwt=0;
      end;
   if deaths = . then deaths = 0;
   totpop+pop;
   totdeath+deaths;
   agerate=(deaths/pop);
   rate=rate+(agerate*proport*100000);
   var2+(deaths * (proport/pop)**2);
   if (proport/pop) > maxwt then maxwt = proport/pop;
   if last.sex then do;
         var2     = var2*(100000**2);
         stderr   = sqrt(var2);
         maxwt    = maxwt*100000;
         glower   = (var2/(2*rate))*cinv(0.025,2*(rate**2)/var2);
         gupper   = ((var2 + maxwt**2)/(2*(rate+maxwt)))*
                    cinv(0.975,2*(rate+maxwt)**2/(var2+maxwt**2));
         output;
      end;
run;

/*
change the case of some names to make them easier to use in R
*/
data ageadjustedrate2(rename=(tyear=year tsex=sex));
   set ageadjustedrate(rename=(sex=tsex year=tyear));
run;
proc export data=ageadjustedrate2 
   outfile = 'c:\user\poisoning\supermicar\analysis\agerate.dat'
   dbms=csv
   replace
   ;
run;
\end{lstlisting}

\bfs
<<>>=
agerate.dat <- read.csv("..\\agerate.dat",header=T)

PlotAdjByYear <- function(drug,color=1,sex='T'){
   with(agerate.dat[agerate.dat$sex==sex & agerate.dat$drugname==drug,], plot(year,rate,
      xlab='Year',ylab='Rate per 100,000',ylim=c(0,6.5),xlim=c(2003,2011),axes=F,col=color,pch=20,
      type='l',lwd=2))
   axis(1,at=c(2003:2010),labels=c(2003:2010))
#   axis(2,las=1)
#   box()
#   with(agerate.dat[agerate.dat$sex==sex & agerate.dat$drugname==drug,], 
#      lines(year,rate,col=color))
}
AddToPlotAdjByYear <- function(drug,color=2,sex='T'){
#   with(agerate.dat[agerate.dat$sex==sex & agerate.dat$drugname==drug,], 
#      points(year,rate,col=color,pch=20))
   with(agerate.dat[agerate.dat$sex==sex & agerate.dat$drugname==drug,], 
      lines(year,rate,col=color,lwd=2))
}

PlotAdjByYear('METHADONE')
AddToPlotAdjByYear('COCAINE',3)
AddToPlotAdjByYear('ALCOHOL',2)
AddToPlotAdjByYear('OXYCODONE',4)
AddToPlotAdjByYear('METHAMPHETAMINE',6)

PlotAdjByYear('METHADONE',sex='M')
AddToPlotAdjByYear('COCAINE',3,sex='M')
AddToPlotAdjByYear('ALCOHOL',2,sex='M')
AddToPlotAdjByYear('OXYCODONE',4,sex='M')
AddToPlotAdjByYear('METHAMPHETAMINE',6,sex='M')

PlotAdjByYear('METHADONE',sex='F')
AddToPlotAdjByYear('COCAINE',3,sex='F')
AddToPlotAdjByYear('ALCOHOL',2,sex='F')
AddToPlotAdjByYear('OXYCODONE',4,sex='F')
AddToPlotAdjByYear('METHAMPHETAMINE',6,sex='F')
@
\efs

\end{detail}

\begin{figure}
<<plotadjbyyear1,fig=T,echo=F,height=5,width=7.5>>=
savepar <- par(mfrow=c(1,3),oma=c(5,5,4,2),mar=c(0,0,0,0))
PlotAdjByYear('METHADONE',sex='T',1)
AddToPlotAdjByYear('ALCOHOL',sex='T',2)
AddToPlotAdjByYear('COCAINE',sex='T',3)
AddToPlotAdjByYear('OXYCODONE',sex='T',4)
AddToPlotAdjByYear('METHAMPHETAMINE',sex='T',6)
axis(2,las=1)
mtext('Rate per 100,000', side=2,line=3.5)
mtext('Year',side=1,line=3)
title('Both sexes',line=-1)

PlotAdjByYear('METHADONE',sex='M',1)
AddToPlotAdjByYear('ALCOHOL',sex='M',2)
AddToPlotAdjByYear('COCAINE',sex='M',3)
AddToPlotAdjByYear('OXYCODONE',sex='M',4)
AddToPlotAdjByYear('METHAMPHETAMINE',sex='M',6)
mtext('Year',side=1,line=3)
title('Men',line=-1)
PlotAdjByYear('METHADONE',sex='F',1)
AddToPlotAdjByYear('ALCOHOL',sex='F',2)
AddToPlotAdjByYear('COCAINE',sex='F',3)
AddToPlotAdjByYear('OXYCODONE',sex='F',4)
AddToPlotAdjByYear('METHAMPHETAMINE',sex='F',6)
mtext('Year',side=1,line=3)
title('Women',line=-1)

legend(2005.5,6.2,legend=c('Methadone','Alcohol','Cocaine','Oxycodone','Methamphetamine'),
   col=c(1,2,3,4,6),lty=c(1,1,1,1,1),lwd=c(2,2,2,2,2))

par(savepar)
@ 
\caption{\label{plotadjbyyear1}Age-adjusted rates of the deaths in which the top 5 drugs are 
named, per 100,000 population, by year.}
\end{figure}
 
\begin{detail}
I will compute the percent of deaths for each intent category (unintentional, suicide, 
undetermined) that are due to each substance category: prescription, illicit, both, or neither.

Then I will count the top ten named substances for each intent category.
For this, I use the file {\tt TcodeLong2}, which contains records for poisoning deaths 
(underlying cause X40--Y19) among Washington residents, and excludes the drugword ``opiate'' when 
the same death record has a specific opiate named, and excludes the duplicates of drug generics 
named more than once on a record (eg if 'ACETAMINOPHEN' and 'TYLENOL' are both on the record, they 
are counted only once).

\begin{lstlisting}[language=sas,caption=drug categories by intent]
libname sm  'c:\data\poisoning\SuperMICAR';
%include "c:\user\poisoning\SuperMICAR\generic.sas";
/*
compute the percent in each intent category that are prescription, illicit, etc.
*/
proc format;
   value $Flag
      '0' = 'Neither'
      '1' = 'Both'
      '2' = 'Prescription'
      '3' = 'Illicit'
      'T' = 'Total'
      ;
   value $intent
      'X40' - 'X49' = 'unintentional'
      'X60' - 'X69' = 'suicide'
      'Y10' - 'Y19' = 'undetermined'
      ;
run;
data intent1;
   set sm.TcodeWide(where=(('X40' le underly3 le 'Y19' and underly3 ne 'X85') and st_res = '48'));
   if illicit_flag = 'N' and prescrip_flag = 'N' then flag = '0';
   if illicit_flag = 'Y' and prescrip_flag = 'Y' then flag = '1';
   if illicit_flag = 'N' and prescrip_flag = 'Y' then flag = '2';
   if illicit_flag = 'Y' and prescrip_flag = 'N' then flag = '3';
   select;
      when('X40' le underly3 le 'X49') intent = 'unintentional';
      when('X60' le underly3 le 'X69') intent = 'suicide';
      when('Y10' le underly3 le 'Y19') intent = 'undetermined';
      end;
   format flag $Flag.;
run;
proc summary data=intent1;
   class intent flag;
   output out=intentsumm1(rename=(_freq_=deaths));
run;
data intentsumm2 intentsumm3;
   set intentsumm1;
   if _type_ = 2 then output intentsumm2;
   if _type_ = 3 then output intentsumm3;
run;
data intentsumm4(drop=_type_);
   merge intentsumm2(drop=flag rename=(deaths=deathstot)) intentsumm3;
   by intent;
   percent = (deaths/deathstot)*100;
run;
proc export data=intentsumm4
   outfile='c:\user\poisoning\supermicar\analysis\intentpercent.dat'
   replace
   dbms=csv;
run;
\end{lstlisting}

see \url{http://www.imachordata.com/?p=730} for advice on {\tt gridExtra}.

\efs
<<>>=
intent.dat <- read.csv('..\\intentpercent.dat')

library(ggplot2)
library(gridExtra)
plot1 <- ggplot(data=intent.dat[intent.dat$intent=='unintentional',],aes(x=percent,y=flag,ylab='')) + 
   geom_point(cex=7,pch=19) + ylab(NULL)
plot2 <- ggplot(data=intent.dat[intent.dat$intent=='suicide',],aes(x=percent,y=flag)) + 
   geom_point(cex=5,pch=19) + ylab(NULL)
plot3 <- ggplot(data=intent.dat[intent.dat$intent=='undetermined',],aes(x=percent,y=flag)) + 
   geom_point(cex=5,pch=19) + ylab(NULL)
grid.arrange(plot1,plot2,plot3,nrow=3)

with(intent.dat,dotchart(percent,groups=intent,pch=19,xlab='Percent'))
axis(side=2,at=c(1:4,7:10,13:16),labels=rep(c('Neither','Both','Prescription','Illicit'),3),line=-3,
   las=1,tick=F)
@
\bfs

\begin{figure}
<<dotplot1,fig=T,echo=F,height=6,width=6>>=
with(intent.dat,dotchart(percent,groups=intent,pch=19,xlab='Percent'))
axis(side=2,at=c(1:4,7:10,13:16),labels=rep(c('Neither','Both','Prescription','Illicit'),3),line=-3,
   las=1,tick=F)
@
\caption{\label{dotplot1}Percent of deaths within each intent category prescription drugs, illicit 
drugs, both, or neither, are named on the death certificate.}
\end{figure}


\begin{lstlisting}[language=sas,caption=count most common substance by intent]
/*
Get count of deaths in each category
*/
proc freq data=intent1;
   tables intent;
run;
/*
results:
     The SAS System                                  10:51 Wednesday, July 11, 2012   8

                         The FREQ Procedure

                                           Cumulative    Cumulative
 intent           Frequency     Percent     Frequency      Percent
 ------------------------------------------------------------------
 suicide              1461       18.72          1461        18.72
 undetermined          495        6.34          1956        25.06
 unintentional        5850       74.94          7806       100.00
*/
/*
Count top ten named substance in each intent category
*/
proc sort data=sm.TcodeLong2;
   by underly3;
run;
proc freq data=sm.TcodeLong2(where=(underly3 ne 'X85')) noprint;
   by underly3;
   format underly3 $intent.;
   tables drugword_genname/out=list1;
run;
proc sort data=list1;
   by underly3 descending count;
run;
data list2;
   set list1;
   by underly3;
   if first.underly3 then i = 0;
   if drugword_genname in ('DRUG','MEDICATION','PRESCRIPTION','ALCOHOLISM') then delete;
   if i le 15 then do;
      output;
      i+1;
      end;
run;
proc print data=list2 uniform;
   by underly3;
run;    
/*
results
                  The SAS System                                  10:51 Wednesday, July 11, 2012  32

 Underlying cause of death (3 dgt)=unintentional ---------------------------------------------------

        drugword_
 Obs    genname            COUNT    PERCENT     i

   1    METHADONE           1941    10.2536     0
   2    ALCOHOL             1181     6.2388     1
   3    COCAINE             1085     5.7316     2
   4    OXYCODONE            870     4.5959     3
   5    METHAMPHETAMINE      604     3.1907     4
   6    MORPHINE             528     2.7892     5
   7    HEROIN               494     2.6096     6
   8    OPIATE               475     2.5092     7
   9    HYDROCODONE          437     2.3085     8
  10    CITALOPRAM           424     2.2398     9
  11    DIAZEPAM             397     2.0972    10
  12    DIPHENHYDRAMINE      387     2.0444    11
  13    ALPRAZOLAM           322     1.7010    12
  14    AMITRIPTYLINE        260     1.3735    13
  15    HYDROMORPHONE        217     1.1463    14
  16    ACETAMINOPHEN        182     0.9614    15


--- Underlying cause of death (3 dgt)=suicide ------------------------------------------------------

        drugword_
 Obs    genname            COUNT    PERCENT     i

  17    CARBON MONOXIDE      288     6.4588     0
  18    ALCOHOL              196     4.3956     1
  19    ACETAMINOPHEN        175     3.9246     2
  20    DIPHENHYDRAMINE      148     3.3191     3
  21    VEHICLE EXHAUST      137     3.0724     4
  22    OXYCODONE            128     2.8706     5
  23    AMITRIPTYLINE        111     2.4893     6
  24    HYDROCODONE           98     2.1978     7
  25    CITALOPRAM            86     1.9287     8
  26    FUMES                 83     1.8614     9
  27    METHADONE             83     1.8614    10
  28    ALPRAZOLAM            70     1.5699    11
  29    MORPHINE              69     1.5474    12
  30    QUETIAPINE            69     1.5474    13
  31    BUPROPION             62     1.3904    14
  32    FLUOXETINE            51     1.1438    15


- Underlying cause of death (3 dgt)=undetermined ---------------------------------------------------

        drugword_
 Obs    genname            COUNT    PERCENT     i

  33    METHADONE            121     7.3156     0
  34    ALCOHOL               69     4.1717     1
  35    COCAINE               53     3.2044     2
  36    OXYCODONE             48     2.9021     3
  37    MORPHINE              47     2.8416     4
  38    METHAMPHETAMINE       46     2.7811     5
  39    DIPHENHYDRAMINE       39     2.3579     6
  40    ACETAMINOPHEN         38     2.2975     7
  41    HEROIN                35     2.1161     8
  42    OPIATE                34     2.0556     9
  43    HYDROCODONE           28     1.6929    10
  44    AMITRIPTYLINE         26     1.5719    11
  45    CITALOPRAM            23     1.3906    12
  46    DIAZEPAM              23     1.3906    13
  47    FLUOXETINE            22     1.3301    14
  48    QUETIAPINE            20     1.2092    15
*/
\end{lstlisting}

\end{detail}

\begin{table}
\begin{small}
\caption{\label{intentlist}The ten most commonly listed substances for each intent category.} 
\begin{tabular}{lrp{4in}} \hline 
intent      & N & commonly named substances (number) \\ \hline
unintentional & 5,850 & methadone      (1,941), alcohol        (1,181), cocaine        (1,085), oxycodone        (870), methamphetamine  (604), morphine         (528), heroin           (494), opiate           (475), hydrocodone      (437), citalopram       (424) \\
suicide       & 1,461 & carbon monoxide (288), alcohol         (196), acetaminophen   (175), diphenhydramine (148), vehicle exhaust (137), oxycodone       (128), amitriptyline   (111), hydrocodone      (98), citalopram       (86), methadone        (83) \\
undetermined  &   495 & methadone      (121), alcohol         (69), cocaine         (53), oxycodone       (48), morphine        (47), methamphetamine (46), diphenhydramine (39), acetaminophen   (38), heroin          (35), opiate          (34)\\
\hline
\end{tabular}

The word ``opiate'' is counted only when a specific opiate is not named on the death record.
\end{small}
\end{table}


\clearpage
\section{Discussion}

The SuperMICAR data system contains all the text entered by the certifier on the cause-of-death portion of the death certificate. We parsed this text to list the individual words and phrases describing the cause of death, and separated the words naming poisoning-related substances or diseases from all other words. We found that these words provided much more detail than the ICD codes. Among the 25 most frequently mentioned poisoning-related substances on Washington State death certificates during 2003--2010, only 4 have an ICD code that specifically identifies them: methadone, alcohol, cocaine, and heroin. The other 21 have ICD codes that include multiple substances, and therefore cannot be definitively identified or counted in data files that include only the ICD codes. We were also able to classify drugs as prescription, illicit, or other, and count the number of deaths associated with prescription drugs, illicit drugs, both, or neither.

Our data suggest that prescription drugs are associated with many more poisoning deaths in Washington State than are other drugs. Prescription drugs were named on more than twice as many certificates as were illicit drugs. For both men and women, the rate of deaths in which only prescription drugs were named was higher throughout 2003--2010 than the rates of deaths in which illicit drugs, both prescription and illicit drugs, or neither, were named. Methadone was the most often named prescription drug on death certificates, followed by oxycodone, morphine, diphenhydramine, and hydrocodone.

The presence of diphenhydramine among the most often named prescription drugs was a surprise. Diphenhydramine is an antihistamine that is an ingredient in many over-the-counter anti-allergy drugs and sleep aids. Its ICD-10 injury code is T45.0, a code it shares with dozens of other drugs~\cite{WHO-ICD-10v3}, and therefore its role in deaths could not have been ascertained with the ICD codes alone.

In contrast with diphenhydramine, oxycodone is well-known as a contributor to drug poisoning deaths~\cite{Cone-2003,Darke-2011}. In the ICD-10, oxycodone is coded to T40.2, the code for ``other opioids,'' a code it shares with all opioids other than opium, methadone, and heroin, each of which has a unique code. Therefore the occurrence of oxycodone deaths cannot be tabulated from ICD codes alone, and has usually been studied with coroner or medical examiner reports~\cite{Cone-2003,Rintoul-2011,Wolf-2005}. In the US, most coroner and medical examiner data is maintained in counties, of which there are more than 3,000. Obtaining these records, and then manually reviewing them to tabulate oxycodone deaths, requires far more resources than using the SuperMICAR data.

The SuperMICAR data also provide a more complete picture of the number of different drugs named on the death certificate than ICD codes do. A convention in coding cause-of-death is to not use the same code more than once on each line of the death certificate. So, for example, if a certifier wrote on line 1 ``fentanyl and tramadol,'' both of which have the ICD-10 code T40.4, then the multiple cause-of-death codes would only include a single code of T40.4 on that line. However, if the certifier named the same drug on two different lines of the death certificate, then that drug would be coded twice, and an analyst using the ICD codes would not know whether the codes represented two different drugs having the same code, or the same drug named twice.

The SuperMICAR text data has been used in a handful of other studies. In Australia, Butt and his colleagues used it, along with the multiple-cause-of-death ICD codes, to develop a machine-learning classifier to identify deaths that had a notifiable cancer on the death certificate~\cite{Butt-2012}. Davis and colleagues fed SuperMICAR data through a natural language processor to develop a system to identify pneumonia and influenza deaths~\cite{Davis-2012}. A national surveillance system for Creutzfeld-Jakob Disease (CJD) in the US has used SuperMICAR text data since 1999~\cite{Holman-2010} (although SuperMICAR data was not available from all states until 2003). The use of the literal text from death certificates allowed the surveillance system to identify and count CJD cases consistently even though an ICD coding change led to inconsistencies in the counts derived from ICD codes. 

The SuperMICAR system was developed by the National Center for Health Statistics in the US, but it is also used in several other countries, including at least Canada~\cite{Peters-1999}, Australia~\cite{Butt-2012}, and South Africa~\cite{Nojilana-2009}. Systems that combine the NCHS SuperMICAR program with local enhancements are used in England, Brazil, Japan and several other countries~\cite{Peters-1999}. 

Several features of SuperMICAR data make it more difficult to use than ICD codes. Since it is free text, computer processing is needed before the data can be tabulated. Parsing the text into words can be accomplished automatically with many different computer systems, including SAS, which we used. However, the individual words may lose their meaning without the context in which they are used. For example, the individual words in `calcium channel blocker' or `car exhaust' don't have the same meaning as the phrases. Therefore it is necessary to build a computer routine to identify and construct phrases. It is also necessary to have a routine to correct misspellings, as these are frequent in the SuperMICAR data. In our data, we found a total of 537 words describing drugs or other substances that could cause poisoning. Combined, these words were misspelled in 442 different ways, with some words, such as cyclobenzaprine and quetapine, being misspelled in more than 10 different ways. We constructed a spelling correction list by examining all words that did not match our list of drug words. It may be possible in some cases to use a publicly available spell-checker, as Davis and colleagues did~\cite{Davis-2012}, but we did not explore that option.

Privacy considerations may lead some agencies to restrict access to SuperMICAR data, because it may sometimes contain text that discloses private information about the decedent or another person. The SuperMICAR text includes the death certificate entry that describes how the injury leading to the death occurred, and this entry occasionally includes a street address, the name of the decedent, or the name of another person involved in the death or who found the injured decedent.



\begin{detail}
May 20, 2013: 
A search on the term ``supermicar'' in pubmed found no results.

A search on Google Scholar found ``about 51'' results. Most were in English. I obtained copies of all the documents in which it appeared that SuperMICAR data was used for studying causes of death.
I'm using:
\begin{itemize}
\item Butt, 2012: used death certifcate data, including the free-text entries and the cause-of-deth codes to train a classifier to classify deaths as having a notifiable cancer or not.
\item Davis-2012
\item Holman-2010
\end{itemize}

From the Holman paper:
In 1999, 18 states had SuperMICAR data available
to NCHS; this number increased to 29 states in 2000, 39 states in
2001, 49 states in 2002, and all states beginning in 2003.

Calcaterra-2013 is an example of a study where SuperMICAR would have been useful. They studied the increase in methamphetamine deaths by using data from CDC Wonder and counting all deaths with the code T43.6, which of course also includes some other drugs. They say ``Limitations in this study relate to the ICD-10 coding for psychostimulants which are not sufficiently sensitive to determine whether deaths were related to methamphetamine versus pharmaceutical psychostimulants such as methylphenidate or amphetamine salts.''

\end{detail}

\subsection{Conclusions}

We found that SuperMICAR data provided details about drug poisoning deaths that could not be obtained from the ICD cause-of-death codes alone. The information from SuperMICAR allowed us to tabulate the actual drugs named on drug poisoning death certificates, and to study the fequency of drug combinations, and to classify deaths as being associated with prescription or illicit drugs. Many of the most frequently named drugs on death certificates are coded to ICD rubrics that contain many different drugs, and therefore cannot be identified by the ICD code alone.

In Washington State during 2003--2010, prescription drugs were associated with more poisoning deaths than were illicit drugs. This was true among both men and women, and at all ages. Although women had lower rates of deaths associated with illicit drugs than men, their rates of deaths associated with prescription drugs were similar to those of men. Methadone was the most frequently named drug, followed by alcohol, cocaine, oxycodone, and methamphetamine.
